!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/modules/export-data",["highcharts","highcharts/modules/exporting"],function(t){return e(t),e.Highcharts=t,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){function e(t,e,a,o){t.hasOwnProperty(e)||(t[e]=o.apply(null,a))}e(t=t?t._modules:{},"Extensions/DownloadURL.js",[t["Core/Globals.js"]],function(t){var i=t.win,n=i.navigator,r=i.document,s=i.URL||i.webkitURL||i,l=/Edge\/\d+/.test(n.userAgent),p=t.dataURLtoBlob=function(t){if((t=t.replace(/filename=.*;/,"").match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/))&&3<t.length&&i.atob&&i.ArrayBuffer&&i.Uint8Array&&i.Blob&&s.createObjectURL){for(var e=i.atob(t[3]),a=new i.ArrayBuffer(e.length),a=new i.Uint8Array(a),o=0;o<a.length;++o)a[o]=e.charCodeAt(o);return t=new i.Blob([a],{type:t[1]}),s.createObjectURL(t)}};return t=t.downloadURL=function(e,t){var a=r.createElement("a");if("string"==typeof e||e instanceof String||!n.msSaveOrOpenBlob){if(e=""+e,(l||2e6<e.length)&&!(e=p(e)||""))throw Error("Failed to convert to blob");if(void 0!==a.download)a.href=e,a.download=t,r.body.appendChild(a),a.click(),r.body.removeChild(a);else try{var o=i.open(e,"chart");if(null==o)throw Error("Failed to open window")}catch(t){i.location.href=e}}else n.msSaveOrOpenBlob(e,t)},{dataURLtoBlob:p,downloadURL:t}}),e(t,"Extensions/ExportData.js",[t["Core/Axis/Axis.js"],t["Core/Chart/Chart.js"],t["Core/Globals.js"],t["Core/Utilities.js"],t["Extensions/DownloadURL.js"]],function(c,t,e,a,o){function i(t,e){var a=s.navigator,o=-1<a.userAgent.indexOf("WebKit")&&a.userAgent.indexOf("Chrome")<0,i=s.URL||s.webkitURL||s;try{if(a.msSaveOrOpenBlob&&s.MSBlobBuilder){var n=new s.MSBlobBuilder;return n.append(t),n.getBlob("image/svg+xml")}if(!o)return i.createObjectURL(new s.Blob(["\ufeff"+t],{type:e}))}catch(t){}}var n=e.doc,r=e.seriesTypes,s=e.win;e=a.addEvent;var d=a.defined,l=a.extend,A=a.find,h=a.fireEvent,p=a.getOptions,C=a.isNumber,S=a.pick;a=a.setOptions;var u=o.downloadURL;a({exporting:{csv:{annotations:{itemDelimiter:"; ",join:!1},columnHeaderFormatter:null,dateFormat:"%Y-%m-%d %H:%M:%S",decimalPoint:null,itemDelimiter:null,lineDelimiter:"\n"},showTable:!1,useMultiLevelHeaders:!0,useRowspanHeaders:!0},lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS",exportData:{annotationHeader:"Annotations",categoryHeader:"Category",categoryDatetimeHeader:"DateTime"},viewData:"View data table",hideData:"Hide data table"}}),e(t,"render",function(){this.options&&this.options.exporting&&this.options.exporting.showTable&&!this.options.chart.forExport&&!this.dataTableDiv&&this.viewData()}),t.prototype.setUpKeyToAxis=function(){r.arearange&&(r.arearange.prototype.keyToAxis={low:"y",high:"y"}),r.gantt&&(r.gantt.prototype.keyToAxis={start:"x",end:"x"})},t.prototype.getDataRows=function(u){function a(t,e,a){if(g.columnHeaderFormatter){var o=g.columnHeaderFormatter(t,e,a);if(!1!==o)return o}return t?t instanceof c?t.options.title&&t.options.title.text||(t.dateTime?n:i):u?{columnTitle:1<a?e:t.name,topLevelColumnTitle:t.name}:t.name+(1<a?" ("+e+")":""):i}function m(a,t,o){var i={},n={};return t.forEach(function(t){var e=(a.keyToAxis&&a.keyToAxis[t]||t)+"Axis",e=C(o)?a.chart[e][o]:a[e];i[t]=e&&e.categories||[],n[t]=e&&e.dateTime}),{categoryMap:i,dateTimeValueAxisMap:n}}var o,f=this.hasParallelCoordinates,x=this.time,g=this.options.exporting&&this.options.exporting.csv||{},b=this.xAxis,y={},t=[],v=[],w=[],e=this.options.lang.exportData,i=e.categoryHeader,n=e.categoryDatetimeHeader,D=[],T=0;for(r in this.setUpKeyToAxis(),this.series.forEach(function(i){var n,t,e,r=i.xAxis,s=i.options.keys||(e=r,(t=i).data.filter(function(t){return void 0!==t.y&&t.name}).length&&e&&!e.categories&&!t.keyToAxis?t.pointArrayMap&&t.pointArrayMap.filter(function(t){return"x"===t}).length?(t.pointArrayMap.unshift("x"),t.pointArrayMap):["x","y"]:t.pointArrayMap||["y"]),l=s.length,p=!i.requireSorting&&{},c=b.indexOf(r),d=m(i,s);if(!1!==i.options.includeInDataExport&&!i.options.isInternal&&!1!==i.visible){for(A(D,function(t){return t[0]===c})||D.push([c,T]),n=0;n<l;)o=a(i,s[n],s.length),w.push(o.columnTitle||o),u&&v.push(o.topLevelColumnTitle||o),n++;var h={chart:i.chart,autoIncrement:i.autoIncrement,options:i.options,pointArrayMap:i.pointArrayMap};i.options.data.forEach(function(t,e){f&&(d=m(i,s,e));var a={series:h};i.pointClass.prototype.applyOptions.apply(a,[t]),t=a.x;var o=i.data[e]&&i.data[e].name;for(n=0,(!r||"name"===i.exportKey||!f&&r&&r.hasNames&&o)&&(t=o),p&&(p[t]&&(t+="|"+e),p[t]=!0),y[t]||(y[t]=[],y[t].xValues=[]),y[t].x=a.x,y[t].name=o,y[t].xValues[c]=a.x;n<l;)o=a[e=s[n]],y[t][T+n]=S(d.categoryMap[e][o],d.dateTimeValueAxisMap[e]?x.dateFormat(g.dateFormat,o):null,o),n++}),T+=n}}),y)Object.hasOwnProperty.call(y,r)&&t.push(y[r]);for(var r=u?[v,w]:[w],T=D.length;T--;){var s=D[T][0],l=D[T][1],p=b[s];t.sort(function(t,e){return t.xValues[s]-e.xValues[s]}),e=a(p),r[0].splice(l,0,e),u&&r[1]&&r[1].splice(l,0,e),t.forEach(function(t){var e=t.name;p&&!d(e)&&(e=p.dateTime?(t.x instanceof Date&&(t.x=t.x.getTime()),x.dateFormat(g.dateFormat,t.x)):p.categories?S(p.names[t.x],p.categories[t.x],t.x):t.x),t.splice(l,0,e)})}return r=r.concat(t),h(this,"exportData",{dataRows:r}),r},t.prototype.getCSV=function(t){var i="",n=this.getDataRows(),e=this.options.exporting.csv,r=S(e.decimalPoint,","!==e.itemDelimiter&&t?1.1.toLocaleString()[1]:"."),s=S(e.itemDelimiter,","===r?";":","),l=e.lineDelimiter;return n.forEach(function(t,e){for(var a,o=t.length;o--;)"string"==typeof(a=t[o])&&(a='"'+a+'"'),"number"==typeof a&&"."!==r&&(a=a.toString().replace(".",r)),t[o]=a;i+=t.join(s),e<n.length-1&&(i+=l)}),i},t.prototype.getTable=function(t){var a='<table id="highcharts-data-table-'+this.index+'">',l=this.options,n=t?1.1.toLocaleString()[1]:".",p=S(l.exporting.useMultiLevelHeaders,!0);t=this.getDataRows(p);function c(t,e,a,o){var i=S(o,"");return e="text"+(e?" "+e:""),"number"==typeof i?(i=i.toString(),","===n&&(i=i.replace(".",n)),e="number"):o||(e="empty"),"<"+t+(a?" "+a:"")+' class="'+e+'">'+i+"</"+t+">"}var o=0,e=p?t.shift():null,i=t.shift();!1!==l.exporting.tableCaption&&(a+='<caption class="highcharts-table-caption">'+S(l.exporting.tableCaption,l.title.text?l.title.text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"):"Chart")+"</caption>");for(var r=0,s=t.length;r<s;++r)t[r].length>o&&(o=t[r].length);return a+=function(t,e,a){var o="<thead>",i=0;a=a||e&&e.length;var n,r=0;if(n=p&&t&&e){t:if(n=t.length,e.length===n){for(;n--;)if(t[n]!==e[n]){n=!1;break t}n=!0}else n=!1;n=!n}if(n){for(o+="<tr>";i<a;++i){n=t[i];var s=t[i+1];n===s?++r:r?(o+=c("th","highcharts-table-topheading",'scope="col" colspan="'+(r+1)+'"',n),r=0):(n===e[i]?l.exporting.useRowspanHeaders?(s=2,delete e[i]):(s=1,e[i]=""):s=1,o+=c("th","highcharts-table-topheading",'scope="col"'+(1<s?' valign="top" rowspan="'+s+'"':""),n))}o+="</tr>"}if(e){for(o+="<tr>",i=0,a=e.length;i<a;++i)void 0!==e[i]&&(o+=c("th",null,'scope="col"',e[i]));o+="</tr>"}return o+"</thead>"}(e,i,Math.max(o,i.length)),a+="<tbody>",t.forEach(function(t){a+="<tr>";for(var e=0;e<o;e++)a+=c(e?"td":"th",null,e?"":'scope="row"',t[e]);a+="</tr>"}),h(this,"afterGetTable",t={html:a+="</tbody></table>"}),t.html},t.prototype.downloadCSV=function(){var t=this.getCSV(!0);u(i(t,"text/csv")||"data:text/csv,\ufeff"+encodeURIComponent(t),this.getFilename()+".csv")},t.prototype.downloadXLS=function(){var t='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";} .text{ mso-number-format:"@";}</style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8></head><body>'+this.getTable(!0)+"</body></html>";u(i(t,"application/vnd.ms-excel")||"data:application/vnd.ms-excel;base64,"+s.btoa(unescape(encodeURIComponent(t))),this.getFilename()+".xls")},t.prototype.viewData=function(){this.dataTableDiv||(this.dataTableDiv=n.createElement("div"),this.dataTableDiv.className="highcharts-data-table",this.renderTo.parentNode.insertBefore(this.dataTableDiv,this.renderTo.nextSibling),this.dataTableDiv.innerHTML=this.getTable()),""!==this.dataTableDiv.style.display&&"none"!==this.dataTableDiv.style.display||(this.dataTableDiv.style.display="block"),this.isDataTableVisible=!0,h(this,"afterViewData",this.dataTableDiv)},t.prototype.hideData=function(){this.dataTableDiv&&"block"===this.dataTableDiv.style.display&&(this.dataTableDiv.style.display="none"),this.isDataTableVisible=!1},t.prototype.toggleDataTable=function(){var t=this.exportDivElements,e=(e=this.options.exporting)&&e.buttons&&e.buttons.contextButton.menuItems,a=this.options.lang;this.isDataTableVisible?this.hideData():this.viewData(),null!=m&&m.menuItemDefinitions&&null!=a&&a.viewData&&a.hideData&&e&&t&&t.length&&(t[e.indexOf("viewData")].innerHTML=this.isDataTableVisible?a.hideData:a.viewData)};var m=p().exporting;m&&(l(m.menuItemDefinitions,{downloadCSV:{textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},downloadXLS:{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}},viewData:{textKey:"viewData",onclick:function(){this.toggleDataTable()}}}),m.buttons&&m.buttons.contextButton.menuItems.push("separator","downloadCSV","downloadXLS","viewData")),r.map&&(r.map.prototype.exportKey="name"),r.mapbubble&&(r.mapbubble.prototype.exportKey="name"),r.treemap&&(r.treemap.prototype.exportKey="name")}),e(t,"masters/modules/export-data.src.js",[],function(){})});