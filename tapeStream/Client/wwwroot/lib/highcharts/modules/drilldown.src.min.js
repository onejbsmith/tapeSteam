"use strict";!function(t){"object"==typeof module&&module.exports?module.exports=t.default=t:"function"==typeof define&&define.amd?define("highcharts/modules/drilldown",["highcharts"],function(e){return t(e),t.Highcharts=e,t}):t("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(e){var t=e?e._modules:{};function i(e,t,i,o){e.hasOwnProperty(t)||(e[t]=o.apply(null,i))}i(t,"Extensions/Drilldown.js",[t["Core/Animation/AnimationUtilities.js"],t["Core/Axis/Axis.js"],t["Core/Chart/Chart.js"],t["Core/Color/Color.js"],t["Core/Globals.js"],t["Core/Options.js"],t["Core/Series/Point.js"],t["Core/Renderer/SVG/SVGRenderer.js"],t["Core/Axis/Tick.js"],t["Core/Utilities.js"]],function(e,t,i,u,o,r,s,n,l,a){var d=e.animObject,f=o.noop,h=r.defaultOptions,p=a.addEvent,c=a.removeEvent,m=a.extend,v=a.fireEvent,g=a.format,w=a.merge,x=a.objectEach,y=a.pick,D=a.syncTimeout,b=o.seriesTypes,S=b.pie,O=b.column,A=1;m(h.lang,{drillUpText:"‚óÅ Back to {series.name}"}),h.drilldown={activeAxisLabelStyle:{cursor:"pointer",color:"#003399",fontWeight:"bold",textDecoration:"underline"},activeDataLabelStyle:{cursor:"pointer",color:"#003399",fontWeight:"bold",textDecoration:"underline"},animation:{duration:500},drillUpButton:{position:{align:"right",x:-10,y:10}}},n.prototype.Element.prototype.fadeIn=function(e){this.attr({opacity:.1,visibility:"inherit"}).animate({opacity:y(this.newOpacity,1)},e||{duration:250})},i.prototype.addSeriesAsDrilldown=function(e,t){this.addSingleSeriesAsDrilldown(e,t),this.applyDrilldown()},i.prototype.addSingleSeriesAsDrilldown=function(e,t){var i,o,r,s,n,l=e.series,a=l.xAxis,d=l.yAxis,h=[],p=[],c=this.styledMode?{colorIndex:y(e.colorIndex,l.colorIndex)}:{color:e.color||l.color};this.drilldownLevels||(this.drilldownLevels=[]),s=l.options._levelNumber||0,(n=this.drilldownLevels[this.drilldownLevels.length-1])&&n.levelNumber!==s&&(n=void 0),t=m(m({_ddSeriesId:A++},c),t),o=l.points.indexOf(e),l.chart.series.forEach(function(e){e.xAxis!==a||e.isDrilling||(e.options._ddSeriesId=e.options._ddSeriesId||A++,e.options._colorIndex=e.userOptions._colorIndex,e.options._levelNumber=e.options._levelNumber||s,n?(h=n.levelSeries,p=n.levelSeriesOptions):(h.push(e),e.purgedOptions=w({_ddSeriesId:e.options._ddSeriesId,_levelNumber:e.options._levelNumber,selected:e.options.selected},e.userOptions),p.push(e.purgedOptions)))}),r=m({levelNumber:s,seriesOptions:l.options,seriesPurgedOptions:l.purgedOptions,levelSeriesOptions:p,levelSeries:h,shapeArgs:e.shapeArgs,bBox:e.graphic?e.graphic.getBBox():{},color:e.isNull?new u(c.color).setOpacity(0).get():c.color,lowerSeriesOptions:t,pointOptions:l.options.data[o],pointIndex:o,oldExtremes:{xMin:a&&a.userMin,xMax:a&&a.userMax,yMin:d&&d.userMin,yMax:d&&d.userMax},resetZoomButton:this.resetZoomButton},c),this.drilldownLevels.push(r),a&&a.names&&(a.names.length=0),(i=r.lowerSeries=this.addSeries(t,!1)).options._levelNumber=s+1,a&&(a.oldPos=a.pos,a.userMin=a.userMax=null,d.userMin=d.userMax=null),l.type===i.type&&(i.animate=i.animateDrilldown||f,i.options.animation=!0)},i.prototype.applyDrilldown=function(){var t,e=this.drilldownLevels;e&&0<e.length&&(t=e[e.length-1].levelNumber,this.drilldownLevels.forEach(function(e){e.levelNumber===t&&e.levelSeries.forEach(function(e){e.options&&e.options._levelNumber===t&&e.remove(!1)})})),this.resetZoomButton&&(this.resetZoomButton.hide(),delete this.resetZoomButton),this.pointer.reset(),this.redraw(),this.showDrillUpButton(),v(this,"afterDrilldown")},i.prototype.getDrilldownBackText=function(){var e,t=this.drilldownLevels;if(t&&0<t.length)return(e=t[t.length-1]).series=e.seriesOptions,g(this.options.lang.drillUpText,e)},i.prototype.showDrillUpButton=function(){var e,t,i=this,o=this.getDrilldownBackText(),r=i.options.drilldown.drillUpButton;this.drillUpButton?this.drillUpButton.attr({text:o}).align():(t=(e=r.theme)&&e.states,this.drillUpButton=this.renderer.button(o,null,null,function(){i.drillUp()},e,t&&t.hover,t&&t.select).addClass("highcharts-drillup-button").attr({align:r.position.align,zIndex:7}).add().align(r.position,!1,r.relativeTo||"plotBox"))},i.prototype.drillUp=function(){if(this.drilldownLevels&&0!==this.drilldownLevels.length){for(var e,o,r,s,t,n=this,i=n.drilldownLevels,l=i[i.length-1].levelNumber,a=i.length,d=n.series,h=function(t){var i;d.forEach(function(e){e.options._ddSeriesId===t._ddSeriesId&&(i=e)}),(i=i||n.addSeries(t,!1)).type===r.type&&i.animateDrillupTo&&(i.animate=i.animateDrillupTo),t===o.seriesPurgedOptions&&(s=i)};a--;)if((o=i[a]).levelNumber===l){if(i.pop(),!(r=o.lowerSeries).chart)for(e=d.length;e--;)if(d[e].options.id===o.lowerSeriesOptions.id&&d[e].options._levelNumber===l+1){r=d[e];break}r.xData=[],o.levelSeriesOptions.forEach(h),v(n,"drillup",{seriesOptions:o.seriesPurgedOptions||o.seriesOptions}),s.type===r.type&&(s.drilldownLevel=o,s.options.animation=n.options.drilldown.animation,r.animateDrillupFrom&&r.chart&&r.animateDrillupFrom(o)),s.options._levelNumber=l,r.remove(!1),s.xAxis&&(t=o.oldExtremes,s.xAxis.setExtremes(t.xMin,t.xMax,!1),s.yAxis.setExtremes(t.yMin,t.yMax,!1)),o.resetZoomButton&&(n.resetZoomButton=o.resetZoomButton,n.resetZoomButton.show())}this.redraw(),0===this.drilldownLevels.length?this.drillUpButton=this.drillUpButton.destroy():this.drillUpButton.attr({text:this.getDrilldownBackText()}).align(),this.ddDupes.length=[],v(n,"drillupall")}},p(i,"afterInit",function(){var i=this;i.drilldown={update:function(e,t){w(!0,i.options.drilldown,e),y(t,!0)&&i.redraw()}}}),p(i,"beforeShowResetZoom",function(){if(this.drillUpButton)return!1}),p(i,"render",function(){(this.xAxis||[]).forEach(function(s){s.ddPoints={},s.series.forEach(function(e){for(var t,i=e.xData||[],o=e.points,r=0;r<i.length;r++)"number"!=typeof(t=e.options.data[r])&&(t=e.pointClass.prototype.optionsToObject.call({series:e},t)).drilldown&&(s.ddPoints[i[r]]||(s.ddPoints[i[r]]=[]),s.ddPoints[i[r]].push(!o||o[r]))}),x(s.ticks,l.prototype.drillable)})}),O.prototype.animateDrillupTo=function(e){var i,s;e||(s=(i=this).drilldownLevel,this.points.forEach(function(e){var t=e.dataLabel;e.graphic&&e.graphic.hide(),t&&(t.hidden="hidden"===t.attr("visibility"),t.hidden||(t.hide(),e.connector&&e.connector.hide()))}),D(function(){var t;i.points&&(t=[],i.data.forEach(function(e){t.push(e)}),i.nodes&&(t=t.concat(i.nodes)),t.forEach(function(e,t){var i=t===(s&&s.pointIndex)?"show":"fadeIn",o="show"==i||void 0,r=e.dataLabel;e.graphic&&e.graphic[i](o),r&&!r.hidden&&(r.fadeIn(),e.connector&&e.connector.fadeIn())}))},Math.max(this.chart.options.drilldown.animation.duration-50,0)),delete this.animate)},O.prototype.animateDrilldown=function(e){var i,o=this,t=this.chart,r=t.drilldownLevels,s=d(t.options.drilldown.animation),n=this.xAxis,l=t.styledMode;e||(r.forEach(function(e){o.options._ddSeriesId===e.lowerSeriesOptions._ddSeriesId&&(i=e.shapeArgs,l||(i.fill=e.color))}),i.x+=y(n.oldPos,n.pos)-n.pos,this.points.forEach(function(e){var t=e.shapeArgs;l||(t.fill=e.color),e.graphic&&e.graphic.attr(i).animate(m(e.shapeArgs,{fill:e.color||o.color}),s),e.dataLabel&&e.dataLabel.fadeIn(s)}),delete this.animate)},O.prototype.animateDrillupFrom=function(r){var s=d(this.chart.options.drilldown.animation),n=this.group,l=n!==this.chart.columnGroup,a=this;a.trackerGroups.forEach(function(e){a[e]&&a[e].on("mouseover")}),l&&delete this.group,this.points.forEach(function(e){function t(){i.destroy(),n&&l&&(n=n.destroy())}var i=e.graphic,o=r.shapeArgs;i&&o&&(delete e.graphic,a.chart.styledMode||(o.fill=r.color),s.duration?i.animate(o,w(s,{complete:t})):(i.attr(o),t()))})},S&&m(S.prototype,{animateDrillupTo:O.prototype.animateDrillupTo,animateDrillupFrom:O.prototype.animateDrillupFrom,animateDrilldown:function(e){var o,r,s,n,l=this.chart.drilldownLevels[this.chart.drilldownLevels.length-1],a=this.chart.options.drilldown.animation;this.is("item")&&(a.duration=0),this.center&&(o=l.shapeArgs,r=o.start,s=(o.end-r)/this.points.length,n=this.chart.styledMode,e||(this.points.forEach(function(e,t){var i=e.shapeArgs;n||(o.fill=l.color,i.fill=e.color),e.graphic&&e.graphic.attr(w(o,{start:r+t*s,end:r+(t+1)*s}))[a?"animate":"attr"](i,a)}),delete this.animate))}}),s.prototype.doDrilldown=function(o,e,t){var i,r=this.series.chart,s=r.options.drilldown,n=(s.series||[]).length;for(r.ddDupes||(r.ddDupes=[]);n--&&!i;)s.series[n].id===this.drilldown&&-1===r.ddDupes.indexOf(this.drilldown)&&(i=s.series[n],r.ddDupes.push(this.drilldown));v(r,"drilldown",{point:this,seriesOptions:i,category:e,originalEvent:t,points:void 0!==e&&this.series.xAxis.getDDPoints(e).slice(0)},function(e){var t=e.point.series&&e.point.series.chart,i=e.seriesOptions;t&&i&&(o?t.addSingleSeriesAsDrilldown(e.point,i):t.addSeriesAsDrilldown(e.point,i))})},t.prototype.drilldownCategory=function(t,i){this.getDDPoints(t).forEach(function(e){e&&e.series&&e.series.visible&&e.doDrilldown&&e.doDrilldown(!0,t,i)}),this.chart.applyDrilldown()},t.prototype.getDDPoints=function(e){return this.ddPoints&&this.ddPoints[e]||[]},l.prototype.drillable=function(){var t=this.pos,e=this.label,i=this.axis,o="xAxis"===i.coll&&i.getDDPoints,r=o&&i.getDDPoints(t),s=i.chart.styledMode;o&&(e&&r&&r.length?(e.drillable=!0,e.basicStyles||s||(e.basicStyles=w(e.styles)),e.addClass("highcharts-drilldown-axis-label"),e.removeOnDrillableClick&&c(e.element,"click"),e.removeOnDrillableClick=p(e.element,"click",function(e){e.preventDefault(),i.drilldownCategory(t,e)}),s||e.css(i.chart.options.drilldown.activeAxisLabelStyle)):e&&e.drillable&&e.removeOnDrillableClick&&(s||(e.styles={},e.css(e.basicStyles)),e.removeOnDrillableClick(),e.removeClass("highcharts-drilldown-axis-label")))},p(s,"afterInit",function(){var t=this,i=t.series;return t.drilldown&&p(t,"click",function(e){i.xAxis&&!1===i.chart.options.drilldown.allowPointDrilldown?i.xAxis.drilldownCategory(t.x,e):t.doDrilldown(void 0,void 0,e)}),t}),p(o.Series,"afterDrawDataLabels",function(){var o=this.chart.options.drilldown.activeDataLabelStyle,r=this.chart.renderer,s=this.chart.styledMode;this.points.forEach(function(e){var t=e.options.dataLabels,i=y(e.dlOptions,t&&t.style,{});e.drilldown&&e.dataLabel&&("contrast"!==o.color||s||(i.color=r.getContrast(e.color||this.color)),t&&t.color&&(i.color=t.color),e.dataLabel.addClass("highcharts-drilldown-data-label"),s||e.dataLabel.css(o).css(i))},this)});function L(e,t,i,o){e[i?"addClass":"removeClass"]("highcharts-drilldown-point"),o||e.css({cursor:t})}p(o.Series,"afterDrawTracker",function(){var t=this.chart.styledMode;this.points.forEach(function(e){e.drilldown&&e.graphic&&L(e.graphic,"pointer",!0,t)})}),p(s,"afterSetState",function(){var e=this.series.chart.styledMode;this.drilldown&&this.series.halo&&"hover"===this.state?L(this.series.halo,"pointer",!0,e):this.series.halo&&L(this.series.halo,"auto",!1,e)})}),i(t,"masters/modules/drilldown.src.js",[],function(){})});