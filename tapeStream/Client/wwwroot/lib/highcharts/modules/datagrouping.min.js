!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/modules/datagrouping",["highcharts"],function(t){return e(t),e.Highcharts=t,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){function e(t,e,o,i){t.hasOwnProperty(e)||(t[e]=i.apply(null,o))}e(t=t?t._modules:{},"Extensions/DataGrouping.js",[t["Core/Axis/Axis.js"],t["Core/Axis/DateTimeAxis.js"],t["Core/Globals.js"],t["Core/Options.js"],t["Core/Series/Point.js"],t["Core/Tooltip.js"],t["Core/Utilities.js"]],function(i,c,t,r,e,o,a){var n=a.addEvent,s=a.arrayMax,p=a.arrayMin,u=a.correctFloat,A=a.defined,l=a.error,d=a.extend,g=a.format,b=a.isNumber,S=a.merge,f=a.pick;a=t.Series;function h(t,e,o,i){var a=this,r=a.data,n=a.options&&a.options.data,s=[],p=[],u=[],l=t.length,h=!!e,d=[],g=a.pointArrayMap,c=g&&g.length,f=["x"].concat(g||["y"]),m=0,D=0;i="function"==typeof i?i:P[i]?P[i]:P[a.getDGApproximation&&a.getDGApproximation()||"average"],c?g.forEach(function(){d.push([])}):d.push([]);for(var x=c||1,y=0;y<=l&&!(t[y]>=o[0]);y++);for(;y<=l;y++){for(;void 0!==o[m+1]&&t[y]>=o[m+1]||y===l;){var v=o[m];a.dataGroupInfo={start:a.cropStart+D,length:d[0].length};var G=i.apply(a,d);for(a.pointClass&&!A(a.dataGroupInfo.options)&&(a.dataGroupInfo.options=S(a.pointClass.prototype.optionsToObject.call({series:a},a.options.data[a.cropStart+D])),f.forEach(function(t){delete a.dataGroupInfo.options[t]})),void 0!==G&&(s.push(v),p.push(G),u.push(a.dataGroupInfo)),D=y,v=0;v<x;v++)d[v].length=0,d[v].hasNulls=!1;if(m+=1,y===l)break}if(y===l)break;if(g)for(v=a.cropStart+y,G=r&&r[v]||a.pointClass.prototype.applyOptions.apply({series:a},[n[v]]),v=0;v<c;v++){var M=G[g[v]];b(M)?d[v].push(M):null===M&&(d[v].hasNulls=!0)}else v=h?e[y]:null,b(v)?d[0].push(v):null===v&&(d[0].hasNulls=!0)}return{groupedXData:s,groupedYData:p,groupMap:u}}var P=t.approximations={sum:function(t){var e=t.length;if(!e&&t.hasNulls)var o=null;else if(e)for(o=0;e--;)o+=t[e];return o},average:function(t){var e=t.length;return t=P.sum(t),b(t)&&e&&(t=u(t/e)),t},averages:function(){var e=[];return[].forEach.call(arguments,function(t){e.push(P.average(t))}),void 0===e[0]?void 0:e},open:function(t){return t.length?t[0]:t.hasNulls?null:void 0},high:function(t){return t.length?s(t):t.hasNulls?null:void 0},low:function(t){return t.length?p(t):t.hasNulls?null:void 0},close:function(t){return t.length?t[t.length-1]:t.hasNulls?null:void 0},ohlc:function(t,e,o,i){if(t=P.open(t),e=P.high(e),o=P.low(o),i=P.close(i),b(t)||b(e)||b(o)||b(i))return[t,e,o,i]},range:function(t,e){return t=P.low(t),e=P.high(e),b(t)||b(e)?[t,e]:null===t&&null===e?null:void 0}},m={approximations:P,groupData:h},D=a.prototype,x=D.processData,y=D.generatePoints,v={groupPixelWidth:2,dateTimeLabelFormats:{millisecond:["%A, %b %e, %H:%M:%S.%L","%A, %b %e, %H:%M:%S.%L","-%H:%M:%S.%L"],second:["%A, %b %e, %H:%M:%S","%A, %b %e, %H:%M:%S","-%H:%M:%S"],minute:["%A, %b %e, %H:%M","%A, %b %e, %H:%M","-%H:%M"],hour:["%A, %b %e, %H:%M","%A, %b %e, %H:%M","-%H:%M"],day:["%A, %b %e, %Y","%A, %b %e","-%A, %b %e, %Y"],week:["Week from %A, %b %e, %Y","%A, %b %e","-%A, %b %e, %Y"],month:["%B %Y","%B","-%B %Y"],year:["%Y","%Y","-%Y"]}},G={line:{},spline:{},area:{},areaspline:{},arearange:{},column:{groupPixelWidth:10},columnrange:{groupPixelWidth:10},candlestick:{groupPixelWidth:10},ohlc:{groupPixelWidth:5}},M=t.defaultDataGroupingUnits=[["millisecond",[1,2,5,10,20,25,50,110,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1]],["week",[1]],["month",[1,3,6]],["year",null]];return D.getDGApproximation=function(){return this.is("arearange")?"range":this.is("ohlc")?"ohlc":this.is("column")?"sum":"average"},D.groupData=h,D.processData=function(){var t,e=this.chart,o=this.options.dataGrouping,i=!1!==this.allowDG&&o&&f(o.enabled,e.options.isStock),a=this.visible||!e.options.chart.ignoreHiddenSeries,r=this.currentDataGrouping,n=!1;if(this.forceCrop=i,this.groupPixelWidth=null,this.hasProcessed=!0,i&&!this.requireSorting&&(this.requireSorting=n=!0),i=!1===x.apply(this,arguments)||!i,n&&(this.requireSorting=!1),!i){this.destroyGroupedData(),i=o.groupAll?this.xData:this.processedXData;var s=o.groupAll?this.yData:this.processedYData,p=e.plotSizeX,u=(e=this.xAxis).options.ordinal;if(h=this.groupPixelWidth=e.getGroupPixelWidth&&e.getGroupPixelWidth()){this.isDirty=t=!0,this.points=null;var l=(n=e.getExtremes()).min,h=h*((n=n.max)-l)/p*(u=u&&e.ordinal&&e.ordinal.getGroupIntervalFactor(l,n,this)||1),p=e.getTimeTicks(c.AdditionsClass.prototype.normalizeTimeTickInterval(h,o.units||M),Math.min(l,i[0]),Math.max(n,i[i.length-1]),e.options.startOfWeek,i,this.closestPointRange),i=(s=D.groupData.apply(this,[i,s,p,o.approximation])).groupedXData;u=s.groupedYData;var d=0;if(o.smoothed&&i.length){var g=i.length-1;for(i[g]=Math.min(i[g],n);g--&&0<g;)i[g]+=h/2;i[0]=Math.max(i[0],l)}for(g=1;g<p.length;g++)p.info.segmentStarts&&-1!==p.info.segmentStarts.indexOf(g)||(d=Math.max(p[g]-p[g-1],d));(l=p.info).gapSize=d,this.closestPointRange=p.info.totalRange,this.groupMap=s.groupMap,A(i[0])&&i[0]<e.min&&a&&((!A(e.options.min)&&e.min<=e.dataMin||e.min===e.dataMin)&&(e.min=Math.min(i[0],e.min)),e.dataMin=Math.min(i[0],e.dataMin)),o.groupAll&&(i=(o=this.cropData(i,u,e.min,e.max,1)).xData,u=o.yData),this.processedXData=i,this.processedYData=u}else this.groupMap=null;this.hasGroupedData=t,this.currentDataGrouping=l,this.preventGraphAnimation=(r&&r.totalRange)!==(l&&l.totalRange)}},D.destroyGroupedData=function(){this.groupedData&&(this.groupedData.forEach(function(t,e){t&&(this.groupedData[e]=t.destroy?t.destroy():null)},this),this.groupedData.length=0)},D.generatePoints=function(){y.apply(this),this.destroyGroupedData(),this.groupedData=this.hasGroupedData?this.points:null},n(e,"update",function(){if(this.dataGroup)return l(24,!1,this.series.chart),!1}),n(o,"headerFormatter",function(t){var e,o,i=this.chart,a=i.time,r=t.labelConfig,n=r.series,s=n.tooltipOptions,p=n.options.dataGrouping,u=s.xDateFormat,l=n.xAxis,h=s[(t.isFooter?"footer":"header")+"Format"];l&&"datetime"===l.options.type&&p&&b(r.key)&&(e=n.currentDataGrouping,p=p.dateTimeLabelFormats||v.dateTimeLabelFormats,e?(s=p[e.unitName],1===e.count?u=s[0]:(u=s[1],o=s[2])):!u&&p&&(u=this.getXDateFormat(r,s,l)),u=a.dateFormat(u,r.key),o&&(u+=a.dateFormat(o,r.key+e.totalRange-1)),n.chart.styledMode&&(h=this.styledModeFormat(h)),t.text=g(h,{point:d(r.point,{key:u}),series:n},i),t.preventDefault())}),n(a,"destroy",D.destroyGroupedData),n(a,"afterSetOptions",function(t){t=t.options;var e=this.type,o=this.chart.options.plotOptions,i=r.defaultOptions.plotOptions[e].dataGrouping,a=this.useCommonDataGrouping&&v;(G[e]||a)&&(i=i||S(v,G[e]),t.dataGrouping=S(a,i,o.series&&o.series.dataGrouping,o[e].dataGrouping,this.userOptions.dataGrouping))}),n(i,"afterSetScale",function(){this.series.forEach(function(t){t.hasProcessed=!1})}),i.prototype.getGroupPixelWidth=function(){for(var t,e=this.series,o=e.length,i=0,a=!1,r=o;r--;)(t=e[r].options.dataGrouping)&&(i=Math.max(i,f(t.groupPixelWidth,v.groupPixelWidth)));for(r=o;r--;)(t=e[r].options.dataGrouping)&&e[r].hasProcessed&&(o=(e[r].processedXData||e[r].data).length,e[r].groupPixelWidth||o>this.chart.plotSizeX/i||o&&t.forced)&&(a=!0);return a?i:0},i.prototype.setDataGrouping=function(e,t){var o;if(t=f(t,!0),e=e||{forced:!1,units:null},this instanceof i)for(o=this.series.length;o--;)this.series[o].update({dataGrouping:e},!1);else this.chart.options.series.forEach(function(t){t.dataGrouping=e},!1);this.ordinal&&(this.ordinal.slope=void 0),t&&this.chart.redraw()},t.dataGrouping=m}),e(t,"masters/modules/datagrouping.src.js",[t["Extensions/DataGrouping.js"]],function(t){return t})});
