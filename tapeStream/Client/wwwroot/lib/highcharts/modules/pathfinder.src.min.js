"use strict";!function(n){"object"==typeof module&&module.exports?module.exports=n.default=n:"function"==typeof define&&define.amd?define("highcharts/modules/pathfinder",["highcharts"],function(t){return n(t),n.Highcharts=t,n}):n("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){var n=t?t._modules:{};function i(t,n,i,r){t.hasOwnProperty(n)||(t[n]=r.apply(null,i))}i(n,"Extensions/ArrowSymbols.js",[n["Core/Renderer/SVG/SVGRenderer.js"]],function(e){e.prototype.symbols.arrow=function(t,n,i,r){return[["M",t,n+r/2],["L",t+i,n],["L",t,n+r/2],["L",t+i,n+r]]},e.prototype.symbols["arrow-half"]=function(t,n,i,r){return e.prototype.symbols.arrow(t,n,i/2,r)},e.prototype.symbols["triangle-left"]=function(t,n,i,r){return[["M",t+i,n],["L",t,n+r/2],["L",t+i,n+r],["Z"]]},e.prototype.symbols["arrow-filled"]=e.prototype.symbols["triangle-left"],e.prototype.symbols["triangle-left-half"]=function(t,n,i,r){return e.prototype.symbols["triangle-left"](t,n,i/2,r)},e.prototype.symbols["arrow-filled-half"]=e.prototype.symbols["triangle-left-half"]}),i(n,"Gantt/Connection.js",[n["Core/Globals.js"],n["Core/Options.js"],n["Core/Series/Point.js"],n["Core/Utilities.js"]],function(t,n,i,r){var e=n.defaultOptions,c=(r.addEvent,r.defined),a=r.error,o=r.extend,x=r.merge,s=r.objectEach,u=(r.pick,r.splat,t.deg2rad),M=Math.max,y=Math.min;function m(t){var n,i=t.shapeArgs;return i?{xMin:i.x,xMax:i.x+i.width,yMin:i.y,yMax:i.y+i.height}:(n=t.graphic&&t.graphic.getBBox())?{xMin:t.plotX-n.width/2,xMax:t.plotX+n.width/2,yMin:t.plotY-n.height/2,yMax:t.plotY+n.height/2}:null}o(e,{connectors:{type:"straight",lineWidth:1,marker:{enabled:!1,align:"center",verticalAlign:"middle",inside:!1,lineWidth:1},startMarker:{symbol:"diamond"},endMarker:{symbol:"arrow-filled"}}});var h=(l.prototype.init=function(t,n,i){this.fromPoint=t,this.toPoint=n,this.options=i,this.chart=t.series.chart,this.pathfinder=this.chart.pathfinder},l.prototype.renderPath=function(t,n,i){var r,e=this.chart,a=e.styledMode,o=e.pathfinder,s=!e.options.chart.forExport&&!1!==i,h=this.graphics&&this.graphics.path;o.group||(o.group=e.renderer.g().addClass("highcharts-pathfinder-group").attr({zIndex:-1}).add(e.seriesGroup)),o.group.translate(e.plotLeft,e.plotTop),h&&h.renderer||(h=e.renderer.path().add(o.group),a||h.attr({opacity:0})),h.attr(n),r={d:t},a||(r.opacity=1),h[s?"animate":"attr"](r,i),this.graphics=this.graphics||{},this.graphics.path=h},l.prototype.addMarker=function(t,n,i){var r,e,a,o,s,h,c,x,M=this,y=M.fromPoint.series.chart,l=y.pathfinder,d=y.renderer,p="start"===t?M.fromPoint:M.toPoint,f=p.getPathfinderAnchorPoint(n);n.enabled&&((x="start"===t?i[1]:i[i.length-2])&&"M"===x[0]||"L"===x[0])&&(c={x:x[1],y:x[2]},e=p.getRadiansToVector(c,f),r=p.getMarkerVector(e,n.radius,f),a=-e/u,n.width&&n.height?(s=n.width,h=n.height):s=h=2*n.radius,M.graphics=M.graphics||{},o={x:r.x-s/2,y:r.y-h/2,width:s,height:h,rotation:a,rotationOriginX:r.x,rotationOriginY:r.y},M.graphics[t]?M.graphics[t].animate(o):(M.graphics[t]=d.symbol(n.symbol).addClass("highcharts-point-connecting-path-"+t+"-marker").attr(o).add(l.group),d.styledMode||M.graphics[t].attr({fill:n.color||M.fromPoint.color,stroke:n.lineColor,"stroke-width":n.lineWidth,opacity:0}).animate({opacity:1},p.series.options.animation)))},l.prototype.getPath=function(t){var n=this.pathfinder,i=this.chart,r=n.algorithms[t.type],e=n.chartObstacles;return"function"!=typeof r?(a('"'+t.type+'" is not a Pathfinder algorithm.'),{path:[],obstacles:[]}):(r.requiresObstacles&&!e&&(e=n.chartObstacles=n.getChartObstacles(t),i.options.connectors.algorithmMargin=t.algorithmMargin,n.chartObstacleMetrics=n.getObstacleMetrics(e)),r(this.fromPoint.getPathfinderAnchorPoint(t.startMarker),this.toPoint.getPathfinderAnchorPoint(t.endMarker),x({chartObstacles:e,lineObstacles:n.lineObstacles||[],obstacleMetrics:n.chartObstacleMetrics,hardBounds:{xMin:0,xMax:i.plotWidth,yMin:0,yMax:i.plotHeight},obstacleOptions:{margin:t.algorithmMargin},startDirectionX:n.getAlgorithmStartDirection(t.startMarker)},t)))},l.prototype.render=function(){var t,n,i=this,r=i.fromPoint,e=r.series,a=e.chart,o=a.pathfinder,s=x(a.options.connectors,e.options.connectors,r.options.connectors,i.options),h={};a.styledMode||(h.stroke=s.lineColor||r.color,h["stroke-width"]=s.lineWidth,s.dashStyle&&(h.dashstyle=s.dashStyle)),h.class="highcharts-point-connecting-path highcharts-color-"+r.colorIndex,s=x(h,s),c(s.marker.radius)||(s.marker.radius=y(M(Math.ceil((s.algorithmMargin||8)/2)-1,1),5)),n=(t=i.getPath(s)).path,t.obstacles&&(o.lineObstacles=o.lineObstacles||[],o.lineObstacles=o.lineObstacles.concat(t.obstacles)),i.renderPath(n,h,e.options.animation),i.addMarker("start",x(s.marker,s.startMarker),n),i.addMarker("end",x(s.marker,s.endMarker),n)},l.prototype.destroy=function(){this.graphics&&(s(this.graphics,function(t){t.destroy()}),delete this.graphics)},l);function l(t,n,i){this.chart=void 0,this.fromPoint=void 0,this.graphics=void 0,this.pathfinder=void 0,this.toPoint=void 0,this.init(t,n,i)}return t.Connection=h,o(i.prototype,{getPathfinderAnchorPoint:function(t){var n,i,r=m(this);switch(t.align){case"right":n="xMax";break;case"left":n="xMin"}switch(t.verticalAlign){case"top":i="yMin";break;case"bottom":i="yMax"}return{x:n?r[n]:(r.xMin+r.xMax)/2,y:i?r[i]:(r.yMin+r.yMax)/2}},getRadiansToVector:function(t,n){var i;return c(n)||(i=m(this))&&(n={x:(i.xMin+i.xMax)/2,y:(i.yMin+i.yMax)/2}),Math.atan2(n.y-t.y,t.x-n.x)},getMarkerVector:function(t,n,i){for(var r,e=2*Math.PI,a=t,o=m(this),s=o.xMax-o.xMin,h=o.yMax-o.yMin,c=Math.atan2(h,s),x=!1,M=s/2,y=h/2,l=o.xMin+M,d=o.yMin+y,p={x:l,y:d},f={},u=1,g=1;a<-Math.PI;)a+=e;for(;a>Math.PI;)a-=e;return r=Math.tan(a),-c<a&&a<=c?(g=-1,x=!0):c<a&&a<=Math.PI-c?g=-1:a>Math.PI-c||a<=-(Math.PI-c)?(u=-1,x=!0):u=-1,x?(p.x+=u*M,p.y+=g*M*r):(p.x+=u*(h/(2*r)),p.y+=g*y),i.x!==l&&(p.x=i.x),i.y!==d&&(p.y=i.y),f.x=p.x+n*Math.cos(a),f.y=p.y-n*Math.sin(a),f}}),h}),i(n,"Gantt/PathfinderAlgorithms.js",[n["Core/Utilities.js"]],function(t){var n=t.extend,w=t.pick,C=Math.min,j=Math.max,A=Math.abs;function I(t,n,i){for(var r,e,a=i||0,o=t.length-1,s=n-1e-7;a<=o;)if(0<(e=s-t[r=o+a>>1].xMin))a=1+r;else{if(!(e<0))return r;o=r-1}return 0<a?a-1:0}function E(t,n){for(var i,r,e=I(t,n.x+1)+1;e--;)if(t[e].xMax>=n.x&&(i=t[e],(r=n).x<=i.xMax&&r.x>=i.xMin&&r.y<=i.yMax&&r.y>=i.yMin))return e;return-1}function R(t){var n=[];if(t.length){n.push(["M",t[0].start.x,t[0].start.y]);for(var i=0;i<t.length;++i)n.push(["L",t[i].end.x,t[i].end.y])}return n}function B(t,n){t.yMin=j(t.yMin,n.yMin),t.yMax=C(t.yMax,n.yMax),t.xMin=j(t.xMin,n.xMin),t.xMax=C(t.xMax,n.xMax)}var i=n(function(t,n,i){var r,e,a,o,s,h,c,x=[],M=w(i.startDirectionX,A(n.x-t.x)>A(n.y-t.y))?"x":"y",y=i.chartObstacles,l=E(y,t),d=E(y,n);function p(t,n,i,r,e){var a={x:t.x,y:t.y};return a[n]=i[r||n]+(e||0),a}function f(t,n,i){var r=A(n[i]-t[i+"Min"])>A(n[i]-t[i+"Max"]);return p(n,i,t,i+(r?"Max":"Min"),r?1:-1)}return c=-1<d?(r={start:o=f(y[d],n,M),end:n},o):n,-1<l&&(o=f(e=y[l],t,M),x.push({start:t,end:o}),o[M]>=t[M]==o[M]>=c[M]&&(h=t[M="y"===M?"x":"y"]<n[M],x.push({start:o,end:p(o,M,e,M+(h?"Max":"Min"),h?1:-1)}),M="y"===M?"x":"y")),o=p(a=x.length?x[x.length-1].end:t,M,c),x.push({start:a,end:o}),s=p(o,M="y"===M?"x":"y",c),x.push({start:o,end:s}),x.push(r),{path:R(x),obstacles:x}},{requiresObstacles:!0});return{fastAvoid:n(function(t,n,d){var i,r,e,a,o,s,h,c,x=w(d.startDirectionX,A(n.x-t.x)>A(n.y-t.y)),M=x?"x":"y",y=[],p=!1,l=d.obstacleMetrics,f=C(t.x,n.x)-l.maxWidth-10,u=j(t.x,n.x)+l.maxWidth+10,g=C(t.y,n.y)-l.maxHeight-10,m=j(t.y,n.y)+l.maxHeight+10,b=d.chartObstacles,v=I(b,f),P=I(b,u);function k(t,n,i){for(var r,e,a=t.x<n.x?1:-1,o=t.x<n.x?(r=t,n):(r=n,t),s=t.y<n.y?(e=t,n):(e=n,t),h=a<0?C(I(b,o.x),b.length-1):0;b[h]&&(0<a&&b[h].xMin<=o.x||a<0&&b[h].xMax>=r.x);){if(b[h].xMin<=o.x&&b[h].xMax>=r.x&&b[h].yMin<=s.y&&b[h].yMax>=e.y)return i?{y:t.y,x:t.x<n.x?b[h].xMin-1:b[h].xMax+1,obstacle:b[h]}:{x:t.x,y:t.y<n.y?b[h].yMin-1:b[h].yMax+1,obstacle:b[h]};h+=a}return n}function O(t,n,i,r,e){var a,o,s=e.soft,h=e.hard,c=r?"x":"y",x={x:n.x,y:n.y},M={x:n.x,y:n.y},y=t[c+"Max"]>=s[c+"Max"],l=t[c+"Min"]<=s[c+"Min"],d=t[c+"Max"]>=h[c+"Max"],p=t[c+"Min"]<=h[c+"Min"],f=A(t[c+"Min"]-n[c]),u=A(t[c+"Max"]-n[c]),g=A(f-u)<10?n[c]<i[c]:u<f;return M[c]=t[c+"Min"],x[c]=t[c+"Max"],a=k(n,M,r)[c]!==M[c],o=k(n,x,r)[c]!==x[c],g=a?!o||g:!o&&g,g=l?!y||g:!y&&g,g=p?!d||g:!d&&g}for(-1<(P=E(b=b.slice(v,P+1),n))&&(a=b[P],o=n,s=t,h=C(a.xMax-o.x,o.x-a.xMin)<C(a.yMax-o.y,o.y-a.yMin),c=O(a,o,s,h,{soft:d.hardBounds,hard:d.hardBounds}),e=h?{y:o.y,x:a[c?"xMax":"xMin"]+(c?1:-1)}:{x:o.x,y:a[c?"yMax":"yMin"]+(c?1:-1)},y.push({end:n,start:e}),n=e);-1<(P=E(b,n));)r=n[M]-t[M]<0,(e={x:n.x,y:n.y})[M]=b[P][r?M+"Max":M+"Min"]+(r?1:-1),y.push({end:n,start:e}),n=e;return{path:R(i=(i=function t(n,i,r){if(n.x===i.x&&n.y===i.y)return[];var e,a,o,s,h,c,x=r?"x":"y",M=d.obstacleOptions.margin,y={soft:{xMin:f,xMax:u,yMin:g,yMax:m},hard:d.hardBounds},l=E(b,n);return-1<l?(s=O(l=b[l],n,i,r,y),B(l,d.hardBounds),c=r?{y:n.y,x:l[s?"xMax":"xMin"]+(s?1:-1)}:{x:n.x,y:l[s?"yMax":"yMin"]+(s?1:-1)},-1<(h=E(b,c))&&(B(h=b[h],d.hardBounds),c[x]=s?j(l[x+"Max"]-M+1,(h[x+"Min"]+l[x+"Max"])/2):C(l[x+"Min"]+M-1,(h[x+"Max"]+l[x+"Min"])/2),p=n.x===c.x&&n.y===c.y&&(p&&(c[x]=s?j(l[x+"Max"],h[x+"Max"])+1:C(l[x+"Min"],h[x+"Min"])-1),!p)),a=[{start:n,end:c}]):(a=[{start:n,end:{x:(e=k(n,{x:r?i.x:n.x,y:r?n.y:i.y},r)).x,y:e.y}}],e[r?"x":"y"]!==i[r?"x":"y"]&&(s=O(e.obstacle,e,i,!r,y),B(e.obstacle,d.hardBounds),o={x:r?e.x:e.obstacle[s?"xMax":"xMin"]+(s?1:-1),y:r?e.obstacle[s?"yMax":"yMin"]+(s?1:-1):e.y},r=!r,a=a.concat(t({x:e.x,y:e.y},o,r)))),a=a.concat(t(a[a.length-1].end,i,!r))}(t,n,x)).concat(y.reverse())),obstacles:i}},{requiresObstacles:!0}),straight:function(t,n){return{path:[["M",t.x,t.y],["L",n.x,n.y]],obstacles:[{start:t,end:n}]}},simpleConnect:i}}),i(n,"Gantt/Pathfinder.js",[n["Gantt/Connection.js"],n["Core/Chart/Chart.js"],n["Core/Globals.js"],n["Core/Options.js"],n["Core/Series/Point.js"],n["Core/Utilities.js"],n["Gantt/PathfinderAlgorithms.js"]],function(c,t,n,i,x,r,e){var a=i.defaultOptions,o=r.addEvent,M=r.defined,s=r.error,h=r.extend,y=r.merge,l=(r.objectEach,r.pick),d=r.splat,p=(n.deg2rad,Math.max),f=Math.min;function m(t){var n,i=t.shapeArgs;return i?{xMin:i.x,xMax:i.x+i.width,yMin:i.y,yMax:i.y+i.height}:(n=t.graphic&&t.graphic.getBBox())?{xMin:t.plotX-n.width/2,xMax:t.plotX+n.width/2,yMin:t.plotY-n.height/2,yMax:t.plotY+n.height/2}:null}h(a,{connectors:{type:"straight",lineWidth:1,marker:{enabled:!1,align:"center",verticalAlign:"middle",inside:!1,lineWidth:1},startMarker:{symbol:"diamond"},endMarker:{symbol:"arrow-filled"}}});var u=(g.prototype.init=function(t){this.chart=t,this.connections=[],o(t,"redraw",function(){this.pathfinder.update()})},g.prototype.update=function(t){var e=this.chart,a=this,n=a.connections;a.connections=[],e.series.forEach(function(t){t.visible&&!t.options.isInternal&&t.points.forEach(function(n){var t=n.options;t&&t.dependency&&(t.connect=t.dependency);var i,r=n.options&&n.options.connect&&d(n.options.connect);n.visible&&!1!==n.isInside&&r&&r.forEach(function(t){(i=e.get("string"==typeof t?t:t.to))instanceof x&&i.series.visible&&i.visible&&!1!==i.isInside&&a.connections.push(new c(n,i,"string"==typeof t?{}:t))})})});for(var i,r,o=0,s=n.length,h=a.connections.length;o<s;++o){for(r=!1,i=0;i<h;++i)if(n[o].fromPoint===a.connections[i].fromPoint&&n[o].toPoint===a.connections[i].toPoint){a.connections[i].graphics=n[o].graphics,r=!0;break}r||n[o].destroy()}delete this.chartObstacles,delete this.lineObstacles,a.renderConnections(t)},g.prototype.renderConnections=function(t){t?this.chart.series.forEach(function(n){function t(){var t=n.chart.pathfinder;(t&&t.connections||[]).forEach(function(t){t.fromPoint&&t.fromPoint.series===n&&t.render()}),n.pathfinderRemoveRenderEvent&&(n.pathfinderRemoveRenderEvent(),delete n.pathfinderRemoveRenderEvent)}!1===n.options.animation?t():n.pathfinderRemoveRenderEvent=o(n,"afterAnimate",t)}):this.connections.forEach(function(t){t.render()})},g.prototype.getChartObstacles=function(t){for(var n,i=[],r=this.chart.series,e=l(t.algorithmMargin,0),a=0,o=r.length;a<o;++a)if(r[a].visible&&!r[a].options.isInternal)for(var s,h,c=0,x=r[a].points.length;c<x;++c)(h=r[a].points[c]).visible&&(s=m(h))&&i.push({xMin:s.xMin-e,xMax:s.xMax+e,yMin:s.yMin-e,yMax:s.yMax+e});return i=i.sort(function(t,n){return t.xMin-n.xMin}),M(t.algorithmMargin)||(n=t.algorithmMargin=function(t){for(var n,i,r=t.length,e=0,a=[],h=function(t,n,i){var r=l(i,10),e=t.yMax+r>n.yMin-r&&t.yMin-r<n.yMax+r,a=t.xMax+r>n.xMin-r&&t.xMin-r<n.xMax+r,o=e?t.xMin>n.xMax?t.xMin-n.xMax:n.xMin-t.xMax:1/0,s=a?t.yMin>n.yMax?t.yMin-n.yMax:n.yMin-t.yMax:1/0;return a&&e?r?h(t,n,Math.floor(r/2)):1/0:f(o,s)};e<r;++e)for(n=e+1;n<r;++n)(i=h(t[e],t[n]))<80&&a.push(i);return a.push(80),p(Math.floor(a.sort(function(t,n){return t-n})[Math.floor(a.length/10)]/2-1),1)}(i),i.forEach(function(t){t.xMin-=n,t.xMax+=n,t.yMin-=n,t.yMax+=n})),i},g.prototype.getObstacleMetrics=function(t){for(var n,i,r=0,e=0,a=t.length;a--;)r<(n=t[a].xMax-t[a].xMin)&&(r=n),e<(i=t[a].yMax-t[a].yMin)&&(e=i);return{maxHeight:e,maxWidth:r}},g.prototype.getAlgorithmStartDirection=function(t){var n="left"!==t.align&&"right"!==t.align,i="top"!==t.verticalAlign&&"bottom"!==t.verticalAlign;return n?i&&void 0:i||void 0},g);function g(t){this.chart=void 0,this.chartObstacles=void 0,this.chartObstacleMetrics=void 0,this.connections=void 0,this.group=void 0,this.lineObstacles=void 0,this.init(t)}return u.prototype.algorithms=e,n.Pathfinder=u,h(x.prototype,{getPathfinderAnchorPoint:function(t){var n,i,r=m(this);switch(t.align){case"right":n="xMax";break;case"left":n="xMin"}switch(t.verticalAlign){case"top":i="yMin";break;case"bottom":i="yMax"}return{x:n?r[n]:(r.xMin+r.xMax)/2,y:i?r[i]:(r.yMin+r.yMax)/2}},getRadiansToVector:function(t,n){var i;return M(n)||(i=m(this))&&(n={x:(i.xMin+i.xMax)/2,y:(i.yMin+i.yMax)/2}),Math.atan2(n.y-t.y,t.x-n.x)},getMarkerVector:function(t,n,i){for(var r,e=2*Math.PI,a=t,o=m(this),s=o.xMax-o.xMin,h=o.yMax-o.yMin,c=Math.atan2(h,s),x=!1,M=s/2,y=h/2,l=o.xMin+M,d=o.yMin+y,p={x:l,y:d},f={},u=1,g=1;a<-Math.PI;)a+=e;for(;a>Math.PI;)a-=e;return r=Math.tan(a),-c<a&&a<=c?(g=-1,x=!0):c<a&&a<=Math.PI-c?g=-1:a>Math.PI-c||a<=-(Math.PI-c)?(u=-1,x=!0):u=-1,x?(p.x+=u*M,p.y+=g*M*r):(p.x+=u*(h/(2*r)),p.y+=g*y),i.x!==l&&(p.x=i.x),i.y!==d&&(p.y=i.y),f.x=p.x+n*Math.cos(a),f.y=p.y-n*Math.sin(a),f}}),t.prototype.callbacks.push(function(t){var n;!1!==t.options.connectors.enabled&&(((n=t).options.pathfinder||n.series.reduce(function(t,n){return n.options&&y(!0,n.options.connectors=n.options.connectors||{},n.options.pathfinder),t||n.options&&n.options.pathfinder},!1))&&(y(!0,n.options.connectors=n.options.connectors||{},n.options.pathfinder),s('WARNING: Pathfinder options have been renamed. Use "chart.connectors" or "series.connectors" instead.')),this.pathfinder=new u(this),this.pathfinder.update(!0))}),u}),i(n,"masters/modules/pathfinder.src.js",[],function(){})});