!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/modules/series-label",["highcharts"],function(t){return e(t),e.Highcharts=t,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){function e(t,e,o,r){t.hasOwnProperty(e)||(t[e]=r.apply(null,o))}e(t=t?t._modules:{},"Extensions/SeriesLabel.js",[t["Core/Animation/AnimationUtilities.js"],t["Core/Chart/Chart.js"],t["Core/Globals.js"],t["Core/Renderer/SVG/SVGRenderer.js"],t["Core/Utilities.js"]],function(t,e,o,r,n){function s(t,e,o,r,i,a){return 0<(t=(a-e)*(o-t)-(r-e)*(i-t))||!(t<0)}function l(t,e,o,r,i,a,h,n){return s(t,e,i,a,h,n)!==s(o,r,i,a,h,n)&&s(t,e,o,r,i,a)!==s(t,e,o,r,h,n)}function g(t,e,o,r,i,a,h,n){return l(t,e,t+o,e,i,a,h,n)||l(t+o,e,t+o,e+r,i,a,h,n)||l(t,e+r,t+o,e+r,i,a,h,n)||l(t,e,t,e+r,i,a,h,n)}function i(i){var a,h;this.renderer&&(h=Y((a=this).renderer.globalAnimation).duration,a.labelSeries=[],a.labelSeriesMaxSum=0,n.clearTimeout(a.seriesLabelTimer),a.series.forEach(function(t){var e=t.options.label,o=t.labelBySeries,r=o&&o.closest;e.enabled&&t.visible&&(t.graph||t.area)&&!t.isSeriesBoosting&&(a.labelSeries.push(t),e.minFontSize&&e.maxFontSize&&(t.sum=t.yData.reduce(function(t,e){return(t||0)+(e||0)},0),a.labelSeriesMaxSum=Math.max(a.labelSeriesMaxSum,t.sum)),"load"===i.type&&(h=Math.max(h,Y(t.options.animation).duration)),r&&(void 0!==r[0].plotX?o.animate({x:r[0].plotX+r[1],y:r[0].plotY+r[2]}):o.attr({opacity:0})))}),a.seriesLabelTimer=c(function(){a.series&&a.labelSeries&&a.drawSeriesLabels()},a.renderer.forExport||!h?0:h))}var Y=t.animObject;t=n.addEvent;var X=n.extend,a=n.fireEvent,w=n.format,f=n.isNumber,M=n.pick,h=n.setOptions,c=n.syncTimeout;o=o.Series,h({plotOptions:{series:{label:{enabled:!0,connectorAllowed:!1,connectorNeighbourDistance:24,format:void 0,formatter:void 0,minFontSize:null,maxFontSize:null,onArea:null,style:{fontWeight:"bold"},boxesToAvoid:[]}}}}),r.prototype.symbols.connector=function(t,e,o,r,i){var a=i&&i.anchorX;i=i&&i.anchorY;var h,n,s=o/2;return f(a)&&f(i)&&(h=[["M",a,i]],(n=e-i)<0&&(n=-r-n),n<o&&(s=a<t+o/2?n:o-n),e+r<i?h.push(["L",t+s,e+r]):i<e?h.push(["L",t+s,e]):a<t?h.push(["L",t,e+r/2]):t+o<a&&h.push(["L",t+o,e+r/2])),h||[]},o.prototype.getPointsOnGraph=function(){function t(t){var e=Math.round(t.plotX/8)+","+Math.round(t.plotY/8);p[e]||(p[e]=1,r.push(t))}if(this.xAxis||this.yAxis){var e,o=this.points,r=[],i=this.graph||this.area,a=i.element,h=this.chart.inverted,n=this.xAxis,s=this.yAxis,l=h?s.pos:n.pos,h=h?n.pos:s.pos,n=M(this.options.label.onArea,!!this.area),c=s.getThreshold(this.options.threshold),p={};if(this.getPointSpline&&a.getPointAtLength&&!n&&o.length<this.chart.plotSizeX/16){i.toD&&(e=i.attr("d"),i.attr({d:i.toD}));for(var d=a.getTotalLength(),u=0;u<d;u+=16)t({chartX:l+(s=a.getPointAtLength(u)).x,chartY:h+s.y,plotX:s.x,plotY:s.y});e&&i.attr({d:e}),(s=o[o.length-1]).chartX=l+s.plotX,s.chartY=h+s.plotY,t(s)}else for(d=o.length,u=0;u<d;u+=1){if(s=o[u],e=o[u-1],s.chartX=l+s.plotX,s.chartY=h+s.plotY,n&&(s.chartCenterY=h+(s.plotY+M(s.yBottom,c))/2),0<u&&(i=Math.abs(s.chartX-e.chartX),a=Math.abs(s.chartY-e.chartY),16<(i=Math.max(i,a))))for(i=Math.ceil(i/16),a=1;a<i;a+=1)t({chartX:e.chartX+a/i*(s.chartX-e.chartX),chartY:e.chartY+a/i*(s.chartY-e.chartY),chartCenterY:e.chartCenterY+a/i*(s.chartCenterY-e.chartCenterY),plotX:e.plotX+a/i*(s.plotX-e.plotX),plotY:e.plotY+a/i*(s.plotY-e.plotY)});f(s.plotY)&&t(s)}return r}},o.prototype.labelFontSize=function(t,e){return t+this.sum/this.chart.labelSeriesMaxSum*(e-t)+"px"},o.prototype.checkClearPoint=function(t,e,o,r){for(var i,a,h,n=Number.MAX_VALUE,s=Number.MAX_VALUE,l=M(this.options.label.onArea,!!this.area),c=l||this.options.label.connectorAllowed,p=this.chart,d=0;d<p.boxesToAvoid.length;d+=1){var u=p.boxesToAvoid[d],f=t+o.width,x=e,b=e+o.height;if(!(t>u.right||f<u.left||x>u.bottom||b<u.top))return!1}for(d=0;d<p.series.length;d+=1)if(u=(x=p.series[d]).interpolatedPoints,x.visible&&u){for(f=1;f<u.length;f+=1){if(u[f].chartX>=t-16&&u[f-1].chartX<=t+o.width+16){if(g(t,e,o.width,o.height,u[f-1].chartX,u[f-1].chartY,u[f].chartX,u[f].chartY))return!1;this===x&&!h&&r&&(h=g(t-16,e-16,o.width+32,o.height+32,u[f-1].chartX,u[f-1].chartY,u[f].chartX,u[f].chartY))}!c&&!h||this===x&&!l||(b=t+o.width/2-u[f].chartX,i=e+o.height/2-u[f].chartY,n=Math.min(n,b*b+i*i))}if(!l&&c&&this===x&&(r&&!h||n<Math.pow(this.options.label.connectorNeighbourDistance,2))){for(f=1;f<u.length;f+=1){(h=Math.min(Math.pow(t+o.width/2-u[f].chartX,2)+Math.pow(e+o.height/2-u[f].chartY,2),Math.pow(t-u[f].chartX,2)+Math.pow(e-u[f].chartY,2),Math.pow(t+o.width-u[f].chartX,2)+Math.pow(e-u[f].chartY,2),Math.pow(t+o.width-u[f].chartX,2)+Math.pow(e+o.height-u[f].chartY,2),Math.pow(t-u[f].chartX,2)+Math.pow(e+o.height-u[f].chartY,2)))<s&&(s=h,a=u[f])}h=!0}}return!(r&&!h)&&{x:t,y:e,weight:n-(a?s:0),connectorPoint:a}},e.prototype.drawSeriesLabels=function(){var y=this,t=this.labelSeries;y.boxesToAvoid=[],t.forEach(function(t){t.interpolatedPoints=t.getPointsOnGraph(),(t.options.label.boxesToAvoid||[]).forEach(function(t){y.boxesToAvoid.push(t)})}),y.series.forEach(function(t){function e(t,e,o){var r=Math.max(s,M(a,-1/0)),i=Math.min(s+c,M(h,1/0));return r<t&&t<=i-o.width&&l<=e&&e<=l+p-o.height}var o=t.options.label;if(o&&(t.xAxis||t.yAxis)){var r,i,a,h,n=[],s=(i=y.inverted)?t.yAxis.pos:t.xAxis.pos,l=i?t.xAxis.pos:t.yAxis.pos,c=y.inverted?t.yAxis.len:t.xAxis.len,p=y.inverted?t.xAxis.len:t.yAxis.len,d=t.interpolatedPoints,u=M(o.onArea,!!t.area),f=t.labelBySeries,x=!f,b=o.minFontSize,g=o.maxFontSize,m="highcharts-color-"+M(t.colorIndex,"none");if(u&&!i&&(i=[t.xAxis.toPixels(t.xData[0]),t.xAxis.toPixels(t.xData[t.xData.length-1])],a=Math.min.apply(Math,i),h=Math.max.apply(Math,i)),t.visible&&!t.isSeriesBoosting&&d){for(f||(f=t.name,"string"==typeof o.format?f=w(o.format,t,y):o.formatter&&(f=o.formatter.call(t)),t.labelBySeries=f=y.renderer.label(f,0,-9999,"connector").addClass("highcharts-series-label highcharts-series-label-"+t.index+" "+(t.options.className||"")+" "+m),y.renderer.styledMode||(f.css(X({color:u?y.renderer.getContrast(t.color):t.color},o.style||{})),f.attr({opacity:y.renderer.forExport?1:0,stroke:t.color,"stroke-width":1})),b&&g&&f.css({fontSize:t.labelFontSize(b,g)}),f.attr({padding:0,zIndex:3}).add()),(b=f.getBBox()).width=Math.round(b.width),i=d.length-1;0<i;--i)u?e(g=d[i].chartX-b.width/2,m=d[i].chartCenterY-b.height/2,b)&&(r=t.checkClearPoint(g,m,b)):(e(g=d[i].chartX+3,m=d[i].chartY-b.height-3,b)&&(r=t.checkClearPoint(g,m,b,!0)),r&&n.push(r),e(g=d[i].chartX+3,m=d[i].chartY+3,b)&&(r=t.checkClearPoint(g,m,b,!0)),r&&n.push(r),e(g=d[i].chartX-b.width-3,m=d[i].chartY+3,b)&&(r=t.checkClearPoint(g,m,b,!0)),r&&n.push(r),e(g=d[i].chartX-b.width-3,m=d[i].chartY-b.height-3,b)&&(r=t.checkClearPoint(g,m,b,!0))),r&&n.push(r);if(o.connectorAllowed&&!n.length&&!u)for(g=s+c-b.width;s<=g;g-=16)for(m=l;m<l+p-b.height;m+=16)(r=t.checkClearPoint(g,m,b,!0))&&n.push(r);n.length?(n.sort(function(t,e){return e.weight-t.weight}),r=n[0],y.boxesToAvoid.push({left:r.x,right:r.x+b.width,top:r.y,bottom:r.y+b.height}),(d=Math.sqrt(Math.pow(Math.abs(r.x-(f.x||0)),2)+Math.pow(Math.abs(r.y-(f.y||0)),2)))&&t.labelBySeries&&(n={opacity:y.renderer.forExport?1:0,x:r.x,y:r.y},o={opacity:1},d<=10&&(o={x:n.x,y:n.y},n={}),d=void 0,x&&((d=Y(t.options.animation)).duration*=.2),t.labelBySeries.attr(X(n,{anchorX:r.connectorPoint&&r.connectorPoint.plotX+s,anchorY:r.connectorPoint&&r.connectorPoint.plotY+l})).animate(o,d),t.options.kdNow=!0,t.buildKDTree(),t=t.searchPoint({chartX:r.x,chartY:r.y},!0))&&(f.closest=[t,r.x-(t.plotX||0),r.y-(t.plotY||0)])):f&&(t.labelBySeries=f.destroy())}else f&&(t.labelBySeries=f.destroy())}}),a(y,"afterDrawSeriesLabels")},t(e,"load",i),t(e,"redraw",i)}),e(t,"masters/modules/series-label.src.js",[],function(){})});