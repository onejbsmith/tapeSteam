"use strict";!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/modules/datagrouping",["highcharts"],function(t){return e(t),e.Highcharts=t,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){var e=t?t._modules:{};function o(t,e,o,a){t.hasOwnProperty(e)||(t[e]=a.apply(null,o))}o(e,"Extensions/DataGrouping.js",[e["Core/Axis/Axis.js"],e["Core/Axis/DateTimeAxis.js"],e["Core/Globals.js"],e["Core/Options.js"],e["Core/Series/Point.js"],e["Core/Tooltip.js"],e["Core/Utilities.js"]],function(a,H,t,n,e,o,i){n.defaultOptions;function r(t,e,o,a){var i,r,n,s,p,u,l,h=this,d=h.data,g=h.options&&h.options.data,c=[],f=[],m=[],D=t.length,x=!!e,y=[],G=h.pointArrayMap,v=G&&G.length,M=["x"].concat(G||["y"]),A=0,b=0;for(s="function"==typeof(l=a)?l:O[l]?O[l]:O[h.getDGApproximation&&h.getDGApproximation()||"average"],v?G.forEach(function(){y.push([])}):y.push([]),p=v||1,u=0;u<=D&&!(t[u]>=o[0]);u++);for(;u<=D;u++){for(;void 0!==o[A+1]&&t[u]>=o[A+1]||u===D;){for(i=o[A],h.dataGroupInfo={start:h.cropStart+b,length:y[0].length},n=s.apply(h,y),h.pointClass&&!W(h.dataGroupInfo.options)&&(h.dataGroupInfo.options=F(h.pointClass.prototype.optionsToObject.call({series:h},h.options.data[h.cropStart+b])),M.forEach(function(t){delete h.dataGroupInfo.options[t]})),void 0!==n&&(c.push(i),f.push(n),m.push(h.dataGroupInfo)),b=u,k=0;k<p;k++)y[k].length=0,y[k].hasNulls=!1;if(A+=1,u===D)break}if(u===D)break;if(G)for(var S,P=h.cropStart+u,H=d&&d[P]||h.pointClass.prototype.applyOptions.apply({series:h},[g[P]]),k=0;k<v;k++)S=H[G[k]],C(S)?y[k].push(S):null===S&&(y[k].hasNulls=!0);else r=x?e[u]:null,C(r)?y[0].push(r):null===r&&(y[0].hasNulls=!0)}return{groupedXData:c,groupedYData:f,groupMap:m}}var s=i.addEvent,p=i.arrayMax,u=i.arrayMin,l=i.correctFloat,W=i.defined,h=i.error,m=i.extend,D=i.format,C=i.isNumber,F=i.merge,k=i.pick,d=t.Series,O=t.approximations={sum:function(t){var e,o=t.length;if(!o&&t.hasNulls)e=null;else if(o)for(e=0;o--;)e+=t[o];return e},average:function(t){var e=t.length,o=O.sum(t);return C(o)&&e&&(o=l(o/e)),o},averages:function(){var e=[];return[].forEach.call(arguments,function(t){e.push(O.average(t))}),void 0===e[0]?void 0:e},open:function(t){return t.length?t[0]:t.hasNulls?null:void 0},high:function(t){return t.length?p(t):t.hasNulls?null:void 0},low:function(t){return t.length?u(t):t.hasNulls?null:void 0},close:function(t){return t.length?t[t.length-1]:t.hasNulls?null:void 0},ohlc:function(t,e,o,a){if(t=O.open(t),e=O.high(e),o=O.low(o),a=O.close(a),C(t)||C(e)||C(o)||C(a))return[t,e,o,a]},range:function(t,e){return t=O.low(t),e=O.high(e),C(t)||C(e)?[t,e]:null===t&&null===e?null:void 0}},g={approximations:O,groupData:r},Y=d.prototype,j=Y.processData,c=Y.generatePoints,x={groupPixelWidth:2,dateTimeLabelFormats:{millisecond:["%A, %b %e, %H:%M:%S.%L","%A, %b %e, %H:%M:%S.%L","-%H:%M:%S.%L"],second:["%A, %b %e, %H:%M:%S","%A, %b %e, %H:%M:%S","-%H:%M:%S"],minute:["%A, %b %e, %H:%M","%A, %b %e, %H:%M","-%H:%M"],hour:["%A, %b %e, %H:%M","%A, %b %e, %H:%M","-%H:%M"],day:["%A, %b %e, %Y","%A, %b %e","-%A, %b %e, %Y"],week:["Week from %A, %b %e, %Y","%A, %b %e","-%A, %b %e, %Y"],month:["%B %Y","%B","-%B %Y"],year:["%Y","%Y","-%Y"]}},f={line:{},spline:{},area:{},areaspline:{},arearange:{},column:{groupPixelWidth:10},columnrange:{groupPixelWidth:10},candlestick:{groupPixelWidth:10},ohlc:{groupPixelWidth:5}},E=t.defaultDataGroupingUnits=[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1]],["week",[1]],["month",[1,3,6]],["year",null]];return Y.getDGApproximation=function(){return this.is("arearange")?"range":this.is("ohlc")?"ohlc":this.is("column")?"sum":"average"},Y.groupData=r,Y.processData=function(){var t,e,o,a,i=this,r=i.chart,n=i.options.dataGrouping,s=!1!==i.allowDG&&n&&k(n.enabled,r.options.isStock),p=i.visible||!r.options.chart.ignoreHiddenSeries,u=this.currentDataGrouping,l=!1;if(i.forceCrop=s,i.groupPixelWidth=null,i.hasProcessed=!0,s&&!i.requireSorting&&(i.requireSorting=l=!0),e=!1===j.apply(i,arguments)||!s,l&&(i.requireSorting=!1),!e){i.destroyGroupedData();var h,d=n.groupAll?i.xData:i.processedXData,g=n.groupAll?i.yData:i.processedYData,c=r.plotSizeX,f=i.xAxis,m=f.options.ordinal,D=i.groupPixelWidth=f.getGroupPixelWidth&&f.getGroupPixelWidth();if(D){t=!0,i.isDirty=!0,i.points=null;var x=f.getExtremes(),y=x.min,G=x.max,v=D*(G-y)/c*(m&&f.ordinal&&f.ordinal.getGroupIntervalFactor(y,G,i)||1),M=f.getTimeTicks(H.AdditionsClass.prototype.normalizeTimeTickInterval(v,n.units||E),Math.min(y,d[0]),Math.max(G,d[d.length-1]),f.options.startOfWeek,d,i.closestPointRange),A=Y.groupData.apply(i,[d,g,M,n.approximation]),b=A.groupedXData,S=A.groupedYData,P=0;if(n.smoothed&&b.length){for(b[h=b.length-1]=Math.min(b[h],G);h--&&0<h;)b[h]+=v/2;b[0]=Math.max(b[0],y)}for(h=1;h<M.length;h++)M.info.segmentStarts&&-1!==M.info.segmentStarts.indexOf(h)||(P=Math.max(M[h]-M[h-1],P));(o=M.info).gapSize=P,i.closestPointRange=M.info.totalRange,i.groupMap=A.groupMap,W(b[0])&&b[0]<f.min&&p&&((!W(f.options.min)&&f.min<=f.dataMin||f.min===f.dataMin)&&(f.min=Math.min(b[0],f.min)),f.dataMin=Math.min(b[0],f.dataMin)),n.groupAll&&(b=(a=i.cropData(b,S,f.min,f.max,1)).xData,S=a.yData),i.processedXData=b,i.processedYData=S}else i.groupMap=null;i.hasGroupedData=t,i.currentDataGrouping=o,i.preventGraphAnimation=(u&&u.totalRange)!==(o&&o.totalRange)}},Y.destroyGroupedData=function(){this.groupedData&&(this.groupedData.forEach(function(t,e){t&&(this.groupedData[e]=t.destroy?t.destroy():null)},this),this.groupedData.length=0)},Y.generatePoints=function(){c.apply(this),this.destroyGroupedData(),this.groupedData=this.hasGroupedData?this.points:null},s(e,"update",function(){if(this.dataGroup)return h(24,!1,this.series.chart),!1}),s(o,"headerFormatter",function(t){var e,o,a,i,r,n=this.chart,s=n.time,p=t.labelConfig,u=p.series,l=u.options,h=u.tooltipOptions,d=l.dataGrouping,g=h.xDateFormat,c=u.xAxis,f=h[(t.isFooter?"footer":"header")+"Format"];c&&"datetime"===c.options.type&&d&&C(p.key)&&(o=u.currentDataGrouping,a=d.dateTimeLabelFormats||x.dateTimeLabelFormats,o?(i=a[o.unitName],1===o.count?g=i[0]:(g=i[1],e=i[2])):!g&&a&&(g=this.getXDateFormat(p,h,c)),r=s.dateFormat(g,p.key),e&&(r+=s.dateFormat(e,p.key+o.totalRange-1)),u.chart.styledMode&&(f=this.styledModeFormat(f)),t.text=D(f,{point:m(p.point,{key:r}),series:u},n),t.preventDefault())}),s(d,"destroy",Y.destroyGroupedData),s(d,"afterSetOptions",function(t){var e=t.options,o=this.type,a=this.chart.options.plotOptions,i=n.defaultOptions.plotOptions[o].dataGrouping,r=this.useCommonDataGrouping&&x;(f[o]||r)&&(i=i||F(x,f[o]),e.dataGrouping=F(r,i,a.series&&a.series.dataGrouping,a[o].dataGrouping,this.userOptions.dataGrouping))}),s(a,"afterSetScale",function(){this.series.forEach(function(t){t.hasProcessed=!1})}),a.prototype.getGroupPixelWidth=function(){for(var t,e,o=this.series,a=o.length,i=0,r=!1,n=a;n--;)(e=o[n].options.dataGrouping)&&(i=Math.max(i,k(e.groupPixelWidth,x.groupPixelWidth)));for(n=a;n--;)(e=o[n].options.dataGrouping)&&o[n].hasProcessed&&(t=(o[n].processedXData||o[n].data).length,(o[n].groupPixelWidth||t>this.chart.plotSizeX/i||t&&e.forced)&&(r=!0));return r?i:0},a.prototype.setDataGrouping=function(e,t){var o;if(t=k(t,!0),e=e||{forced:!1,units:null},this instanceof a)for(o=this.series.length;o--;)this.series[o].update({dataGrouping:e},!1);else this.chart.options.series.forEach(function(t){t.dataGrouping=e},!1);this.ordinal&&(this.ordinal.slope=void 0),t&&this.chart.redraw()},t.dataGrouping=g}),o(e,"masters/modules/datagrouping.src.js",[e["Extensions/DataGrouping.js"]],function(t){return t})});