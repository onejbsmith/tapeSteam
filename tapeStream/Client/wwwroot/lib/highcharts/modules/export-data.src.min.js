"use strict";!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/modules/export-data",["highcharts","highcharts/modules/exporting"],function(t){return e(t),e.Highcharts=t,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){var e=t?t._modules:{};function a(t,e,a,o){t.hasOwnProperty(e)||(t[e]=o.apply(null,a))}a(e,"Extensions/DownloadURL.js",[e["Core/Globals.js"]],function(t){var s=t.win,o=s.navigator,n=s.document,l=s.URL||s.webkitURL||s,i=/Edge\/\d+/.test(o.userAgent),r=t.dataURLtoBlob=function(t){var e=t.replace(/filename=.*;/,"").match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/);if(e&&3<e.length&&s.atob&&s.ArrayBuffer&&s.Uint8Array&&s.Blob&&l.createObjectURL){for(var a=s.atob(e[3]),o=new s.ArrayBuffer(a.length),n=new s.Uint8Array(o),i=0;i<n.length;++i)n[i]=a.charCodeAt(i);var r=new s.Blob([n],{type:e[1]});return l.createObjectURL(r)}},e=t.downloadURL=function(e,t){var a=n.createElement("a");if("string"==typeof e||e instanceof String||!o.msSaveOrOpenBlob){if(e=""+e,(i||2e6<e.length)&&!(e=r(e)||""))throw new Error("Failed to convert to blob");if(void 0!==a.download)a.href=e,a.download=t,n.body.appendChild(a),a.click(),n.body.removeChild(a);else try{if(null==s.open(e,"chart"))throw new Error("Failed to open window")}catch(t){s.location.href=e}}else o.msSaveOrOpenBlob(e,t)};return{dataURLtoBlob:r,downloadURL:e}}),a(e,"Extensions/ExportData.js",[e["Core/Axis/Axis.js"],e["Core/Chart/Chart.js"],e["Core/Globals.js"],e["Core/Utilities.js"],e["Extensions/DownloadURL.js"]],function(u,t,e,a,o){var n=e.doc,i=e.seriesTypes,r=e.win,s=a.addEvent,f=a.defined,l=a.extend,S=a.find,m=a.fireEvent,p=a.getOptions,L=a.isNumber,E=a.pick,c=a.setOptions,d=o.downloadURL;function h(t,e){var a=r.navigator,o=-1<a.userAgent.indexOf("WebKit")&&a.userAgent.indexOf("Chrome")<0,n=r.URL||r.webkitURL||r;try{if(a.msSaveOrOpenBlob&&r.MSBlobBuilder){var i=new r.MSBlobBuilder;return i.append(t),i.getBlob("image/svg+xml")}if(!o)return n.createObjectURL(new r.Blob(["\ufeff"+t],{type:e}))}catch(t){}}c({exporting:{csv:{annotations:{itemDelimiter:"; ",join:!1},columnHeaderFormatter:null,dateFormat:"%Y-%m-%d %H:%M:%S",decimalPoint:null,itemDelimiter:null,lineDelimiter:"\n"},showTable:!1,useMultiLevelHeaders:!0,useRowspanHeaders:!0},lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS",exportData:{annotationHeader:"Annotations",categoryHeader:"Category",categoryDatetimeHeader:"DateTime"},viewData:"View data table",hideData:"Hide data table"}}),s(t,"render",function(){this.options&&this.options.exporting&&this.options.exporting.showTable&&!this.options.chart.forExport&&!this.dataTableDiv&&this.viewData()}),t.prototype.setUpKeyToAxis=function(){i.arearange&&(i.arearange.prototype.keyToAxis={low:"y",high:"y"}),i.gantt&&(i.gantt.prototype.keyToAxis={start:"x",end:"x"})},t.prototype.getDataRows=function(n){function e(t,e,a){if(y.columnHeaderFormatter){var o=y.columnHeaderFormatter(t,e,a);if(!1!==o)return o}return t?t instanceof u?t.options.title&&t.options.title.text||(t.dateTime?h:d):n?{columnTitle:1<a?e:t.name,topLevelColumnTitle:t.name}:t.name+(1<a?" ("+e+")":""):d}function x(o,t,n){var i={},r={};return t.forEach(function(t){var e=(o.keyToAxis&&o.keyToAxis[t]||t)+"Axis",a=L(n)?o.chart[e][n]:o[e];i[t]=a&&a.categories||[],r[t]=a&&a.dateTime}),{categoryMap:i,dateTimeValueAxisMap:r}}var a,t,o,i,r,s,l,g=this.hasParallelCoordinates,b=this.time,y=this.options.exporting&&this.options.exporting.csv||{},v=this.xAxis,w={},p=[],D=[],T=[],c=this.options.lang.exportData,d=c.categoryHeader,h=c.categoryDatetimeHeader,A=[],C=0;for(i in this.setUpKeyToAxis(),this.series.forEach(function(s){var l,p,t=s.options.keys,c=s.xAxis,d=t||function(t,e){if(!t.data.filter(function(t){return void 0!==t.y&&t.name}).length||!e||e.categories||t.keyToAxis)return t.pointArrayMap||["y"];if(t.pointArrayMap&&t.pointArrayMap.filter(function(t){return"x"===t}).length)return t.pointArrayMap.unshift("x"),t.pointArrayMap;return["x","y"]}(s,c),h=d.length,u=!s.requireSorting&&{},f=v.indexOf(c),m=x(s,d);if(!1!==s.options.includeInDataExport&&!s.options.isInternal&&!1!==s.visible){for(S(A,function(t){return t[0]===f})||A.push([f,C]),p=0;p<h;)o=e(s,d[p],d.length),T.push(o.columnTitle||o),n&&D.push(o.topLevelColumnTitle||o),p++;l={chart:s.chart,autoIncrement:s.autoIncrement,options:s.options,pointArrayMap:s.pointArrayMap},s.options.data.forEach(function(t,e){var a,o,n,i,r;for(g&&(m=x(s,d,e)),r={series:l},s.pointClass.prototype.applyOptions.apply(r,[t]),a=r.x,i=s.data[e]&&s.data[e].name,p=0,(!c||"name"===s.exportKey||!g&&c&&c.hasNames&&i)&&(a=i),u&&(u[a]&&(a+="|"+e),u[a]=!0),w[a]||(w[a]=[],w[a].xValues=[]),w[a].x=r.x,w[a].name=i,w[a].xValues[f]=r.x;p<h;)n=r[o=d[p]],w[a][C+p]=E(m.categoryMap[o][n],m.dateTimeValueAxisMap[o]?b.dateFormat(y.dateFormat,n):null,n),p++}),C+=p}}),w)Object.hasOwnProperty.call(w,i)&&p.push(w[i]);for(t=n?[D,T]:[T],C=A.length;C--;)s=A[C][0],l=A[C][1],a=v[s],p.sort(function(t,e){return t.xValues[s]-e.xValues[s]}),r=e(a),t[0].splice(l,0,r),n&&t[1]&&t[1].splice(l,0,r),p.forEach(function(t){var e=t.name;a&&!f(e)&&(e=a.dateTime?(t.x instanceof Date&&(t.x=t.x.getTime()),b.dateFormat(y.dateFormat,t.x)):a.categories?E(a.names[t.x],a.categories[t.x],t.x):t.x),t.splice(l,0,e)});return t=t.concat(p),m(this,"exportData",{dataRows:t}),t},t.prototype.getCSV=function(t){var n="",i=this.getDataRows(),e=this.options.exporting.csv,r=E(e.decimalPoint,","!==e.itemDelimiter&&t?1.1.toLocaleString()[1]:"."),s=E(e.itemDelimiter,","===r?";":","),l=e.lineDelimiter;return i.forEach(function(t,e){for(var a="",o=t.length;o--;)"string"==typeof(a=t[o])&&(a='"'+a+'"'),"number"==typeof a&&"."!==r&&(a=a.toString().replace(".",r)),t[o]=a;n+=t.join(s),e<i.length-1&&(n+=l)}),n},t.prototype.getTable=function(t){function p(t,e,a,o){var n=E(o,""),i="text"+(e?" "+e:"");return"number"==typeof n?(n=n.toString(),","===r&&(n=n.replace(".",r)),i="number"):o||(i="empty"),"<"+t+(a?" "+a:"")+' class="'+i+'">'+n+"</"+t+">"}var a='<table id="highcharts-data-table-'+this.index+'">',c=this.options,r=t?1.1.toLocaleString()[1]:".",d=E(c.exporting.useMultiLevelHeaders,!0),e=this.getDataRows(d),o=0,n=d?e.shift():null,i=e.shift();!1!==c.exporting.tableCaption&&(a+='<caption class="highcharts-table-caption">'+E(c.exporting.tableCaption,c.title.text?c.title.text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"):"Chart")+"</caption>");for(var s=0,l=e.length;s<l;++s)e[s].length>o&&(o=e[s].length);a+=function(t,e,a){var o,n,i="<thead>",r=0,s=a||e&&e.length,l=0;if(d&&t&&e&&!function(t,e){var a=t.length;if(e.length!==a)return!1;for(;a--;)if(t[a]!==e[a])return!1;return!0}(t,e)){for(i+="<tr>";r<s;++r)(o=t[r])===t[r+1]?++l:l?(i+=p("th","highcharts-table-topheading",'scope="col" colspan="'+(l+1)+'"',o),l=0):(o===e[r]?c.exporting.useRowspanHeaders?(n=2,delete e[r]):(n=1,e[r]=""):n=1,i+=p("th","highcharts-table-topheading",'scope="col"'+(1<n?' valign="top" rowspan="'+n+'"':""),o));i+="</tr>"}if(e){for(i+="<tr>",r=0,s=e.length;r<s;++r)void 0!==e[r]&&(i+=p("th",null,'scope="col"',e[r]));i+="</tr>"}return i+="</thead>"}(n,i,Math.max(o,i.length)),a+="<tbody>",e.forEach(function(t){a+="<tr>";for(var e=0;e<o;e++)a+=p(e?"td":"th",null,e?"":'scope="row"',t[e]);a+="</tr>"});var h={html:a+="</tbody></table>"};return m(this,"afterGetTable",h),h.html},t.prototype.downloadCSV=function(){var t=this.getCSV(!0);d(h(t,"text/csv")||"data:text/csv,\ufeff"+encodeURIComponent(t),this.getFilename()+".csv")},t.prototype.downloadXLS=function(){var t,e='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";} .text{ mso-number-format:"@";}</style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8></head><body>'+this.getTable(!0)+"</body></html>";d(h(e,"application/vnd.ms-excel")||"data:application/vnd.ms-excel;base64,"+(t=e,r.btoa(unescape(encodeURIComponent(t)))),this.getFilename()+".xls")},t.prototype.viewData=function(){this.dataTableDiv||(this.dataTableDiv=n.createElement("div"),this.dataTableDiv.className="highcharts-data-table",this.renderTo.parentNode.insertBefore(this.dataTableDiv,this.renderTo.nextSibling),this.dataTableDiv.innerHTML=this.getTable()),""!==this.dataTableDiv.style.display&&"none"!==this.dataTableDiv.style.display||(this.dataTableDiv.style.display="block"),this.isDataTableVisible=!0,m(this,"afterViewData",this.dataTableDiv)},t.prototype.hideData=function(){this.dataTableDiv&&"block"===this.dataTableDiv.style.display&&(this.dataTableDiv.style.display="none"),this.isDataTableVisible=!1},t.prototype.toggleDataTable=function(){var t=this.exportDivElements,e=this.options.exporting,a=e&&e.buttons&&e.buttons.contextButton.menuItems,o=this.options.lang;this.isDataTableVisible?this.hideData():this.viewData(),null!=x&&x.menuItemDefinitions&&null!=o&&o.viewData&&o.hideData&&a&&t&&t.length&&(t[a.indexOf("viewData")].innerHTML=this.isDataTableVisible?o.hideData:o.viewData)};var x=p().exporting;x&&(l(x.menuItemDefinitions,{downloadCSV:{textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},downloadXLS:{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}},viewData:{textKey:"viewData",onclick:function(){this.toggleDataTable()}}}),x.buttons&&x.buttons.contextButton.menuItems.push("separator","downloadCSV","downloadXLS","viewData")),i.map&&(i.map.prototype.exportKey="name"),i.mapbubble&&(i.mapbubble.prototype.exportKey="name"),i.treemap&&(i.treemap.prototype.exportKey="name")}),a(e,"masters/modules/export-data.src.js",[],function(){})});