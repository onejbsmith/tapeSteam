"use strict";import A from"../Core/Animation/AnimationUtilities.js";var stop=A.stop;import Chart from"../Core/Chart/Chart.js";import H from"../Core/Globals.js";import U from"../Core/Utilities.js";var addEvent=U.addEvent,createElement=U.createElement,pick=U.pick;addEvent(Chart,"afterSetChartSize",function(t){var i,e,s,h=this.options.chart.scrollablePlotArea,l=h&&h.minWidth,r=h&&h.minHeight;this.renderer.forExport||(l?(this.scrollablePixelsX=i=Math.max(0,l-this.chartWidth),i&&(this.plotWidth+=i,this.inverted?(this.clipBox.height+=i,this.plotBox.height+=i):(this.clipBox.width+=i,this.plotBox.width+=i),s={1:{name:"right",value:i}})):r&&(this.scrollablePixelsY=e=Math.max(0,r-this.chartHeight),e&&(this.plotHeight+=e,this.inverted?(this.clipBox.width+=e,this.plotBox.width+=e):(this.clipBox.height+=e,this.plotBox.height+=e),s={2:{name:"bottom",value:e}})),s&&!t.skipAxes&&this.axes.forEach(function(t){s[t.side]?t.getPlotLinePath=function(){var i,e=s[t.side].name,h=s[t.side].value,l=this[e];return this[e]=l-h,i=H.Axis.prototype.getPlotLinePath.apply(this,arguments),this[e]=l,i}:(t.setAxisSize(),t.setAxisTranslation())}))}),addEvent(Chart,"render",function(){this.scrollablePixelsX||this.scrollablePixelsY?(this.setUpScrolling&&this.setUpScrolling(),this.applyFixed()):this.fixedDiv&&this.applyFixed()}),Chart.prototype.setUpScrolling=function(){var t=this,i={WebkitOverflowScrolling:"touch",overflowX:"hidden",overflowY:"hidden"};this.scrollablePixelsX&&(i.overflowX="auto"),this.scrollablePixelsY&&(i.overflowY="auto"),this.scrollingParent=createElement("div",{className:"highcharts-scrolling-parent"},{position:"relative"},this.renderTo),this.scrollingContainer=createElement("div",{className:"highcharts-scrolling"},i,this.scrollingParent),addEvent(this.scrollingContainer,"scroll",function(){t.pointer&&delete t.pointer.chartPosition}),this.innerContainer=createElement("div",{className:"highcharts-inner-container"},null,this.scrollingContainer),this.innerContainer.appendChild(this.container),this.setUpScrolling=null},Chart.prototype.moveFixedElements=function(){var t,i=this.container,e=this.fixedRenderer,s=[".highcharts-contextbutton",".highcharts-credits",".highcharts-legend",".highcharts-legend-checkbox",".highcharts-navigator-series",".highcharts-navigator-xaxis",".highcharts-navigator-yaxis",".highcharts-navigator",".highcharts-reset-zoom",".highcharts-scrollbar",".highcharts-subtitle",".highcharts-title"];this.scrollablePixelsX&&!this.inverted?t=".highcharts-yaxis":this.scrollablePixelsX&&this.inverted?t=".highcharts-xaxis":this.scrollablePixelsY&&!this.inverted?t=".highcharts-xaxis":this.scrollablePixelsY&&this.inverted&&(t=".highcharts-yaxis"),s.push(t,t+"-labels"),s.forEach(function(t){[].forEach.call(i.querySelectorAll(t),function(t){(t.namespaceURI===e.SVG_NS?e.box:e.box.parentNode).appendChild(t),t.style.pointerEvents="auto"})})},Chart.prototype.applyFixed=function(){var t,i,e,s,h,l=!this.fixedDiv,r=this.options.chart.scrollablePlotArea;l?(this.fixedDiv=createElement("div",{className:"highcharts-fixed"},{position:"absolute",overflow:"hidden",pointerEvents:"none",zIndex:2,top:0},null,!0),null===(t=this.scrollingContainer)||void 0===t||t.parentNode.insertBefore(this.fixedDiv,this.scrollingContainer),this.renderTo.style.overflow="visible",this.fixedRenderer=e=new H.Renderer(this.fixedDiv,this.chartWidth,this.chartHeight,null===(i=this.options.chart)||void 0===i?void 0:i.style),this.scrollableMask=e.path().attr({fill:this.options.chart.backgroundColor||"#fff","fill-opacity":pick(r.opacity,.85),zIndex:-1}).addClass("highcharts-scrollable-mask").add(),this.moveFixedElements(),addEvent(this,"afterShowResetZoom",this.moveFixedElements),addEvent(this,"afterLayOutTitles",this.moveFixedElements)):this.fixedRenderer.setSize(this.chartWidth,this.chartHeight),s=this.chartWidth+(this.scrollablePixelsX||0),h=this.chartHeight+(this.scrollablePixelsY||0),stop(this.container),this.container.style.width=s+"px",this.container.style.height=h+"px",this.renderer.boxWrapper.attr({width:s,height:h,viewBox:[0,0,s,h].join(" ")}),this.chartBackground.attr({width:s,height:h}),this.scrollingContainer.style.height=this.chartHeight+"px",l&&(r.scrollPositionX&&(this.scrollingContainer.scrollLeft=this.scrollablePixelsX*r.scrollPositionX),r.scrollPositionY&&(this.scrollingContainer.scrollTop=this.scrollablePixelsY*r.scrollPositionY));var o,a=this.axisOffset,n=this.plotTop-a[0]-1,c=this.plotLeft-a[3]-1,d=this.plotTop+this.plotHeight+a[2]+1,p=this.plotLeft+this.plotWidth+a[1]+1,g=this.plotLeft+this.plotWidth-(this.scrollablePixelsX||0),x=this.plotTop+this.plotHeight-(this.scrollablePixelsY||0);o=this.scrollablePixelsX?[["M",0,n],["L",this.plotLeft-1,n],["L",this.plotLeft-1,d],["L",0,d],["Z"],["M",g,n],["L",this.chartWidth,n],["L",this.chartWidth,d],["L",g,d],["Z"]]:this.scrollablePixelsY?[["M",c,0],["L",c,this.plotTop-1],["L",p,this.plotTop-1],["L",p,0],["Z"],["M",c,x],["L",c,this.chartHeight],["L",p,this.chartHeight],["L",p,x],["Z"]]:[["M",0,0]],"adjustHeight"!==this.redrawTrigger&&this.scrollableMask.attr({d:o})};