"use strict";import Chart from"../../../Core/Chart/Chart.js";import SVGRenderer from"../../../Core/Renderer/SVG/SVGRenderer.js";import U from"../../../Core/Utilities.js";var addEvent=U.addEvent,defined=U.defined,merge=U.merge,objectEach=U.objectEach,uniqueKey=U.uniqueKey,defaultMarkers={arrow:{tagName:"marker",render:!1,id:"arrow",refY:5,refX:9,markerWidth:10,markerHeight:10,children:[{tagName:"path",d:"M 0 0 L 10 5 L 0 10 Z",strokeWidth:0}]},"reverse-arrow":{tagName:"marker",render:!1,id:"reverse-arrow",refY:5,refX:1,markerWidth:10,markerHeight:10,children:[{tagName:"path",d:"M 0 5 L 10 0 L 10 10 Z",strokeWidth:0}]}};function createMarkerSetter(r){return function(e){this.attr(r,"url(#"+e+")")}}SVGRenderer.prototype.addMarker=function(r,e){var t={id:r},a={stroke:e.color||"none",fill:e.color||"rgba(0, 0, 0, 0.75)"};t.children=e.children.map(function(r){return merge(a,r)});var i=this.definition(merge(!0,{markerWidth:20,markerHeight:20,refX:0,refY:0,orient:"auto"},e,t));return i.id=r,i};var markerMixin={markerEndSetter:createMarkerSetter("marker-end"),markerStartSetter:createMarkerSetter("marker-start"),setItemMarkers:function(r){var e=r.options,t=r.chart,a=t.options.defs,i=e.fill,n=defined(i)&&"none"!==i?i:e.stroke;["markerStart","markerEnd"].forEach(function(i){var d,o,m,f,s=e[i];if(s){for(m in a)if(s===(d=a[m]).id&&"marker"===d.tagName){o=d;break}o&&(f=r[i]=t.renderer.addMarker((e.id||uniqueKey())+"-"+o.id,merge(o,{color:n})),r.attr(i,f.attr("id")))}})}};addEvent(Chart,"afterGetContainer",function(){this.options.defs=merge(defaultMarkers,this.options.defs||{}),objectEach(this.options.defs,function(r){"marker"===r.tagName&&!1!==r.render&&this.renderer.addMarker(r.id,r)},this)});export default markerMixin;