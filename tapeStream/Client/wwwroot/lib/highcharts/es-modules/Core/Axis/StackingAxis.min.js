import A from"../Animation/AnimationUtilities.js";var getDeferredAnimation=A.getDeferredAnimation;import U from"../Utilities.js";var addEvent=U.addEvent,destroyObjectProperties=U.destroyObjectProperties,fireEvent=U.fireEvent,objectEach=U.objectEach,pick=U.pick,StackingAxisAdditions=function(){function t(t){this.oldStacks={},this.stacks={},this.stacksTouched=0,this.axis=t}return t.prototype.buildStacks=function(){var t,i,e=this.axis,s=e.series,o=pick(e.options.reversedStacks,!0),n=s.length;if(!e.isXAxis){for(this.usePercentage=!1,i=n;i--;)(t=s[o?i:n-i-1]).setStackedPoints(),t.setGroupedPoints();for(i=0;i<n;i++)s[i].modifyStacks();fireEvent(e,"afterBuildStacks")}},t.prototype.cleanStacks=function(){var t;this.axis.isXAxis||(this.oldStacks&&(t=this.stacks=this.oldStacks),objectEach(t,function(t){objectEach(t,function(t){t.cumulative=t.total})}))},t.prototype.resetStacks=function(){var t=this,i=t.axis,e=t.stacks;i.isXAxis||objectEach(e,function(i){objectEach(i,function(e,s){e.touched<t.stacksTouched?(e.destroy(),delete i[s]):(e.total=null,e.cumulative=null)})})},t.prototype.renderStackTotals=function(){var t=this.axis,i=t.chart,e=i.renderer,s=this.stacks,o=t.options.stackLabels.animation,n=getDeferredAnimation(i,o),a=this.stackTotalGroup=this.stackTotalGroup||e.g("stack-labels").attr({visibility:"visible",zIndex:6,opacity:0}).add();a.translate(i.plotLeft,i.plotTop),objectEach(s,function(t){objectEach(t,function(t){t.render(a)})}),a.animate({opacity:1},n)},t}(),StackingAxis=function(){function t(){}return t.compose=function(i){i.prototype;addEvent(i,"init",t.onInit),addEvent(i,"destroy",t.onDestroy)},t.onDestroy=function(){var t=this.stacking;if(t){var i=t.stacks;objectEach(i,function(t,e){destroyObjectProperties(t),i[e]=null}),t&&t.stackTotalGroup&&t.stackTotalGroup.destroy()}},t.onInit=function(){this.stacking||(this.stacking=new StackingAxisAdditions(this))},t}();export default StackingAxis;