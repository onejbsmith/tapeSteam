import H from"../../Globals.js";var isFirefox=H.isFirefox,isMS=H.isMS,isWebKit=H.isWebKit,win=H.win;import SVGElement from"../SVG/SVGElement.js";import SVGRenderer from"../SVG/SVGRenderer.js";import U from"../../Utilities.js";var attr=U.attr,createElement=U.createElement,extend=U.extend,pick=U.pick,HTMLRenderer=SVGRenderer;extend(SVGRenderer.prototype,{getTransformKey:function(){return isMS&&!/Edge/.test(win.navigator.userAgent)?"-ms-transform":isWebKit?"-webkit-transform":isFirefox?"MozTransform":win.opera?"-o-transform":""},html:function(t,e,r){var n=this.createElement("span"),i=n.element,s=n.renderer,o=s.isSVG,a=function(t,e){["opacity","visibility"].forEach(function(r){t[r+"Setter"]=function(n,i,s){var o=t.div?t.div.style:e;SVGElement.prototype[r+"Setter"].call(this,n,i,s),o&&(o[i]=n)}}),t.addedSetters=!0};return n.textSetter=function(t){t!==i.innerHTML&&(delete this.bBox,delete this.oldTextWidth),this.textStr=t,i.innerHTML=pick(t,""),n.doTransform=!0},o&&a(n,n.element.style),n.xSetter=n.ySetter=n.alignSetter=n.rotationSetter=function(t,e){"align"===e?n.alignValue=n.textAlign=t:n[e]=t,n.doTransform=!0},n.afterSetters=function(){this.doTransform&&(this.htmlUpdateTransform(),this.doTransform=!1)},n.attr({text:t,x:Math.round(e),y:Math.round(r)}).css({position:"absolute"}),s.styledMode||n.css({fontFamily:this.style.fontFamily,fontSize:this.style.fontSize}),i.style.whiteSpace="nowrap",n.css=n.htmlCss,o&&(n.add=function(t){var e,r,o=s.box.parentNode,l=[];if(this.parentGroup=t,t){if(!(e=t.div)){for(r=t;r;)l.push(r),r=r.parentGroup;l.reverse().forEach(function(t){var r,i=attr(t.element,"class");function s(e,n){t[n]=e,"translateX"===n?r.left=e+"px":r.top=e+"px",t.doTransform=!0}e=t.div=t.div||createElement("div",i?{className:i}:void 0,{position:"absolute",left:(t.translateX||0)+"px",top:(t.translateY||0)+"px",display:t.display,opacity:t.opacity,pointerEvents:t.styles&&t.styles.pointerEvents},e||o),r=e.style,extend(t,{classSetter:function(t){return function(e){this.element.setAttribute("class",e),t.className=e}}(e),on:function(){return l[0].div&&n.on.apply({element:l[0].div},arguments),t},translateXSetter:s,translateYSetter:s}),t.addedSetters||a(t)})}}else e=o;return e.appendChild(i),n.added=!0,n.alignOnAdd&&n.htmlUpdateTransform(),n}),n}});export default HTMLRenderer;