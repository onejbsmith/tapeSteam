"use strict";import H from"../Globals.js";var win=H.win;import U from"../Utilities.js";var isNumber=U.isNumber,objectEach=U.objectEach,Fx=function(){function t(t,e,i){this.pos=NaN,this.options=e,this.elem=t,this.prop=i}return t.prototype.dSetter=function(){var t=this.paths,e=t&&t[0],i=t&&t[1],s=[],r=this.now||0;if(1!==r&&e&&i)if(e.length===i.length&&r<1)for(var n=0;n<i.length;n++){for(var o=e[n],h=i[n],l=[],p=0;p<h.length;p++){var a=o[p],u=h[p];"number"==typeof a&&"number"==typeof u&&("A"!==h[0]||4!==p&&5!==p)?l[p]=a+r*(u-a):l[p]=u}s.push(l)}else s=i;else s=this.toD||[];this.elem.attr("d",s,void 0,!0)},t.prototype.update=function(){var t=this.elem,e=this.prop,i=this.now,s=this.options.step;this[e+"Setter"]?this[e+"Setter"]():t.attr?t.element&&t.attr(e,i,null,!0):t.style[e]=i+this.unit,s&&s.call(t,i,this)},t.prototype.run=function(t,e,i){var s=this,r=s.options,n=function(t){return!n.stopped&&s.step(t)},o=win.requestAnimationFrame||function(t){setTimeout(t,13)},h=function(){for(var t=0;t<H.timers.length;t++)H.timers[t]()||H.timers.splice(t--,1);H.timers.length&&o(h)};t!==e||this.elem["forceAnimate:"+this.prop]?(this.startTime=+new Date,this.start=t,this.end=e,this.unit=i,this.now=this.start,this.pos=0,n.elem=this.elem,n.prop=this.prop,n()&&1===H.timers.push(n)&&o(h)):(delete r.curAnim[this.prop],r.complete&&0===Object.keys(r.curAnim).length&&r.complete.call(this.elem))},t.prototype.step=function(t){var e,i,s=+new Date,r=this.options,n=this.elem,o=r.complete,h=r.duration,l=r.curAnim;return n.attr&&!n.element?e=!1:t||s>=h+this.startTime?(this.now=this.end,this.pos=1,this.update(),l[this.prop]=!0,i=!0,objectEach(l,function(t){!0!==t&&(i=!1)}),i&&o&&o.call(n),e=!1):(this.pos=r.easing((s-this.startTime)/h),this.now=this.start+(this.end-this.start)*this.pos,this.update(),e=!0),e},t.prototype.initPath=function(t,e,i){var s,r,n,o,h=t.startX,l=t.endX,p=e&&e.slice(),a=i.slice(),u=t.isArea,c=u?2:1;if(!p)return[a,a];function m(t,e){for(;t.length<r;){var i=t[0],s=e[r-t.length];s&&"M"===i[0]&&("C"===s[0]?t[0]=["C",i[1],i[2],i[1],i[2],i[1],i[2]]:t[0]=["L",i[1],i[2]]),t.unshift(i),u&&t.push(t[t.length-1])}}function f(t,e){for(;t.length<r;){var i=t[t.length/c-1].slice();if("C"===i[0]&&(i[1]=i[5],i[2]=i[6]),u){var s=t[t.length/c].slice();t.splice(t.length/2,0,i,s)}else t.push(i)}}if(h&&l){for(n=0;n<h.length;n++){if(h[n]===l[0]){s=n;break}if(h[0]===l[l.length-h.length+n]){s=n,o=!0;break}if(h[h.length-1]===l[l.length-h.length+n]){s=h.length-n;break}}void 0===s&&(p=[])}return p.length&&isNumber(s)&&(r=a.length+s*c,o?(m(p,a),f(a)):(m(a,p),f(p))),[p,a]},t.prototype.fillSetter=function(){t.prototype.strokeSetter.apply(this,arguments)},t.prototype.strokeSetter=function(){this.elem.attr(this.prop,H.color(this.start).tweenTo(H.color(this.end),this.pos),null,!0)},t}();H.Fx=Fx;export default Fx;