import BaseSeries from"../../Core/Series/Series.js";import RequiredIndicatorMixin from"../../Mixins/IndicatorRequired.js";import U from"../../Core/Utilities.js";var correctFloat=U.correctFloat,isArray=U.isArray,EMAindicator=BaseSeries.seriesTypes.ema;BaseSeries.seriesType("tema","ema",{},{init:function(){var e=arguments,t=this;RequiredIndicatorMixin.isParentLoaded(EMAindicator,"ema",t.type,function(i){i.prototype.init.apply(t,e)})},getEMA:function(e,t,i,r,l,a){return EMAindicator.prototype.calculateEma(a||[],e,void 0===l?1:l,this.chart.series[0].EMApercent,t,void 0===r?-1:r,i)},getTemaPoint:function(e,t,i,r){return[e[r-3],correctFloat(3*i.level1-3*i.level2+i.level3)]},getValues:function(e,t){var i,r,l,a,o=t.period,s=2*o,n=3*o,v=e.xData,c=e.yData,p=c?c.length:0,u=-1,d=0,h=0,m=[],A=[],M=[],y=[],E=[],f={};if(e.EMApercent=2/(o+1),!(p<3*o-2)){for(isArray(c[0])&&(u=t.index?t.index:0),h=(d=EMAindicator.prototype.accumulatePeriodPoints(o,u,c))/o,d=0,l=o;l<p+3;l++)l<p+1&&(f.level1=this.getEMA(c,i,h,u,l)[1],y.push(f.level1)),i=f.level1,l<s?d+=f.level1:(l===s&&(h=d/o,d=0),f.level1=y[l-o-1],f.level2=this.getEMA([f.level1],r,h)[1],E.push(f.level2),r=f.level2,l<n?d+=f.level2:(l===n&&(h=d/o),l===p+1&&(f.level1=y[l-o-1],f.level2=this.getEMA([f.level1],r,h)[1],E.push(f.level2)),f.level1=y[l-o-2],f.level2=E[l-2*o-1],f.level3=this.getEMA([f.level2],f.prevLevel3,h)[1],(a=this.getTemaPoint(v,n,f,l))&&(m.push(a),A.push(a[0]),M.push(a[1])),f.prevLevel3=f.level3));return{values:m,xData:A,yData:M}}}});