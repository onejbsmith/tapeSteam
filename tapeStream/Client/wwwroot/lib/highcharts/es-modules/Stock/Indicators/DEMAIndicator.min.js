import BaseSeries from"../../Core/Series/Series.js";import RequiredIndicatorMixin from"../../Mixins/IndicatorRequired.js";import U from"../../Core/Utilities.js";var correctFloat=U.correctFloat,isArray=U.isArray,EMAindicator=BaseSeries.seriesTypes.ema;BaseSeries.seriesType("dema","ema",{},{init:function(){var e=arguments,i=this;RequiredIndicatorMixin.isParentLoaded(EMAindicator,"ema",i.type,function(r){r.prototype.init.apply(i,e)})},getEMA:function(e,i,r,t,a,o){return EMAindicator.prototype.calculateEma(o||[],e,void 0===a?1:a,this.chart.series[0].EMApercent,i,void 0===t?-1:t,r)},getValues:function(e,i){var r,t,a,o,s,n=i.period,c=2*n,p=e.xData,d=e.yData,u=d?d.length:0,m=-1,y=0,A=0,M=[],l=[],h=[],E=0,f=[];if(e.EMApercent=2/(n+1),!(u<2*n-1)){for(isArray(d[0])&&(m=i.index?i.index:0),A=(y=EMAindicator.prototype.accumulatePeriodPoints(n,m,d))/n,y=0,o=n;o<u+2;o++)o<u+1&&(E=this.getEMA(d,t,A,m,o)[1],f.push(E)),t=E,o<c?y+=E:(o===c&&(A=y/n),E=f[o-n-1],r=this.getEMA([E],a,A)[1],s=[p[o-2],correctFloat(2*E-r)],M.push(s),l.push(s[0]),h.push(s[1]),a=r);return{values:M,xData:l,yData:h}}}});