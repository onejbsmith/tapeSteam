import BaseSeries from"../../Core/Series/Series.js";import U from"../../Core/Utilities.js";var isArray=U.isArray;function accumulateAverage(e,a,r,t){var s=a[t],i=r[t];e.push([s,i])}function getTR(e,a){var r=e,t=a,s=r[1]-r[2],i=void 0===t?0:Math.abs(r[1]-t[3]),u=void 0===t?0:Math.abs(r[2]-t[3]);return Math.max(s,i,u)}function populateAverage(e,a,r,t,s,i){return[a[t-1],(i*(s-1)+getTR(r[t-1],r[t-2]))/s]}BaseSeries.seriesType("atr","sma",{params:{period:14}},{getValues:function(e,a){var r,t,s,i=a.period,u=e.xData,o=e.yData,p=o?o.length:0,n=1,h=0,g=0,v=[],l=[],m=[];if(s=[[u[0],o[0]]],!(u.length<=i)&&isArray(o[0])&&4===o[0].length){for(t=1;t<=p;t++)accumulateAverage(s,u,o,t),i<n?(h=(r=populateAverage(s,u,o,t,i,h))[1],v.push(r),l.push(r[0]),m.push(r[1])):i===n?(h=g/(t-1),v.push([u[t-1],h]),l.push(u[t-1]),m.push(h),n++):(g+=getTR(o[t-1],o[t-2]),n++);return{values:v,xData:l,yData:m}}}});