import BaseSeries from"../../Core/Series/Series.js";BaseSeries.seriesType("cmf","sma",{params:{period:14,volumeSeriesID:"volume"}},{nameBase:"Chaikin Money Flow",isValid:function(){var e=this.chart,a=this.options,s=this.linkedParent,t=this.volumeSeries||(this.volumeSeries=e.get(a.params.volumeSeriesID)),i=s&&s.yData&&4===s.yData[0].length;function r(e){return e.xData&&e.xData.length>=a.params.period}return!!(s&&t&&r(s)&&r(t)&&i)},getValues:function(e,a){if(this.isValid())return this.getMoneyFlow(e.xData,e.yData,this.volumeSeries.yData,a.period)},getMoneyFlow:function(e,a,s,t){var i,r,n=a.length,l=[],u=0,o=0,h=[],p=[],m=[],f=-1;function D(e,a){var s,t,r,n=e[1],l=e[2],u=e[3];return null!==a&&null!==n&&null!==l&&null!==u&&n!==l?((r=u)-(t=l)-((s=n)-r))/(s-t)*a:(f=i,null)}if(t>0&&t<=n){for(i=0;i<t;i++)l[i]=D(a[i],s[i]),u+=s[i],o+=l[i];for(h.push(e[i-1]),p.push(i-f>=t&&0!==u?o/u:null),m.push([h[0],p[0]]);i<n;i++)l[i]=D(a[i],s[i]),u-=s[i-t],u+=s[i],o-=l[i-t],o+=l[i],r=[e[i],i-f>=t?o/u:null],h.push(r[0]),p.push(r[1]),m.push([r[0],r[1]])}return{values:m,xData:h,yData:p}}});