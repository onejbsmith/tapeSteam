import BaseSeries from"../../Core/Series/Series.js";function toFixed(e,t){return parseFloat(e.toFixed(t))}function calculateDirection(e,t,i,n){return 1===e&&t>n||-1===e&&i>n?1:-1}function getAccelerationFactor(e,t,i,n,a,r,c,o){return e===t?1===e&&i>n?a===c?c:toFixed(a+r,2):-1===e&&i<n?a===c?c:toFixed(a+r,2):a:o}function getExtremePoint(e,t,i,n){return 1===i?e>n?e:n:t<n?t:n}function getEPMinusPSAR(e,t){return e-t}function getAccelerationFactorMultiply(e,t){return e*t}function getPSAR(e,t,i,n,a,r,c,o,l){return e===t?1===e?i+n<Math.min(a,r)?i+n:Math.min(a,r):i+n>Math.max(o,c)?i+n:Math.max(o,c):l}BaseSeries.seriesType("psar","sma",{lineWidth:0,marker:{enabled:!0},states:{hover:{lineWidthPlus:0}},params:{initialAccelerationFactor:.02,maxAccelerationFactor:.2,increment:.02,index:2,decimals:4}},{nameComponents:!1,getValues:function(e,t){var i,n,a,r,c,o,l,u,s,m,F,x,h=e.xData,A=e.yData,d=A[0][1],g=t.initialAccelerationFactor,p=t.maxAccelerationFactor,f=t.increment,M=t.initialAccelerationFactor,P=A[0][2],S=t.decimals,y=t.index,D=[],E=[],R=[],v=1;if(!(y>=A.length)){for(x=0;x<y;x++)d=Math.max(A[x][1],d),P=Math.min(A[x][2],toFixed(P,S));for(i=A[x][1]>P?1:-1,n=getEPMinusPSAR(d,P),a=getAccelerationFactorMultiply(g=t.initialAccelerationFactor,n),D.push([h[y],P]),E.push(h[y]),R.push(toFixed(P,S)),x=y+1;x<A.length;x++)c=A[x-1][2],o=A[x-2][2],l=A[x-1][1],u=A[x-2][1],m=A[x][1],F=A[x][2],null!==o&&null!==u&&null!==c&&null!==l&&null!==m&&null!==F&&(P=getPSAR(i,v,P,a,o,c,l,u,d),s=getExtremePoint(m,F,i,d),a=getAccelerationFactorMultiply(g=getAccelerationFactor(r=calculateDirection(v,F,m,P),i,s,d,g,f,p,M),n=getEPMinusPSAR(s,P)),D.push([h[x],toFixed(P,S)]),E.push(h[x]),R.push(toFixed(P,S)),v=i,i=r,d=s);return{values:D,xData:E,yData:R}}}});