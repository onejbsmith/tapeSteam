import BaseSeries from"../../Core/Series/Series.js";import MultipleLinesMixin from"../../Mixins/MultipleLines.js";import U from"../../Core/Utilities.js";var isArray=U.isArray,merge=U.merge,SMA=BaseSeries.seriesTypes.sma;function getStandardDeviation(e,i,t,o){for(var a,r=0,s=e.length,n=0;n<s;n++)r+=(a=(t?e[n][i]:e[n])-o)*a;return r/=s-1,Math.sqrt(r)}BaseSeries.seriesType("bb","sma",{params:{period:20,standardDeviation:2,index:3},bottomLine:{styles:{lineWidth:1,lineColor:void 0}},topLine:{styles:{lineWidth:1,lineColor:void 0}},tooltip:{pointFormat:'<span style="color:{point.color}">‚óè</span><b> {series.name}</b><br/>Top: {point.top}<br/>Middle: {point.middle}<br/>Bottom: {point.bottom}<br/>'},marker:{enabled:!1},dataGrouping:{approximation:"averages"}},merge(MultipleLinesMixin,{pointArrayMap:["top","middle","bottom"],pointValKey:"middle",nameComponents:["period","standardDeviation"],linesApiNames:["topLine","bottomLine"],init:function(){SMA.prototype.init.apply(this,arguments),this.options=merge({topLine:{styles:{lineColor:this.color}},bottomLine:{styles:{lineColor:this.color}}},this.options)},getValues:function(e,i){var t,o,a,r,s,n,l,p,d,m,y=i.period,h=i.standardDeviation,u=e.xData,b=e.yData,g=b?b.length:0,D=[],v=[],M=[];if(!(u.length<y)){for(p=isArray(b[0]),m=y;m<=g;m++)s=u.slice(m-y,m),n=b.slice(m-y,m),r=(d=SMA.prototype.getValues.call(this,{xData:s,yData:n},i)).xData[0],o=(t=d.yData[0])+h*(l=getStandardDeviation(n,i.index,p,t)),a=t-h*l,D.push([r,o,t,a]),v.push(r),M.push([o,t,a]);return{values:D,xData:v,yData:M}}}}));