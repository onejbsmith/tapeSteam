import BaseSeries from"../../Core/Series/Series.js";import MultipleLinesMixin from"../../Mixins/MultipleLines.js";import U from"../../Core/Utilities.js";var correctFloat=U.correctFloat,merge=U.merge,SMA=BaseSeries.seriesTypes.sma;function getBaseForBand(e,t,a){return correctFloat(t-e)/(correctFloat(t+e)/2)*1e3*a}function getPointUB(e,t){return e*correctFloat(1+2*t)}function getPointLB(e,t){return e*correctFloat(1-2*t)}BaseSeries.seriesType("abands","sma",{params:{period:20,factor:.001,index:3},lineWidth:1,topLine:{styles:{lineWidth:1}},bottomLine:{styles:{lineWidth:1}},dataGrouping:{approximation:"averages"}},merge(MultipleLinesMixin,{pointArrayMap:["top","middle","bottom"],pointValKey:"middle",nameBase:"Acceleration Bands",nameComponents:["period","factor"],linesApiNames:["topLine","bottomLine"],getValues:function(e,t){var a,i,o,r,s,n,l,p,c,m,u,d=t.period,y=t.factor,g=t.index,D=e.xData,x=e.yData,B=x?x.length:0,f=[],h=[],M=[],L=[],S=[];if(!(B<d)){for(u=0;u<=B;u++)u<B&&(s=getBaseForBand(x[u][2],x[u][1],y),f.push(getPointUB(x[u][1],s)),h.push(getPointLB(x[u][2],s))),u>=d&&(c=D.slice(u-d,u),m=x.slice(u-d,u),l=SMA.prototype.getValues.call(this,{xData:c,yData:f.slice(u-d,u)},{period:d}),p=SMA.prototype.getValues.call(this,{xData:c,yData:h.slice(u-d,u)},{period:d}),r=(n=SMA.prototype.getValues.call(this,{xData:c,yData:m},{period:d,index:g})).xData[0],i=l.yData[0],o=p.yData[0],a=n.yData[0],M.push([r,i,a,o]),L.push(r),S.push([i,a,o]));return{values:M,xData:L,yData:S}}}}));