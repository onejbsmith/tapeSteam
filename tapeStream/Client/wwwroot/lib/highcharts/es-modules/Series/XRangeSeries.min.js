import Axis from"../Core/Axis/Axis.js";import BaseSeries from"../Core/Series/Series.js";import H from"../Core/Globals.js";import Color from"../Core/Color/Color.js";var color=Color.parse;import Point from"../Core/Series/Point.js";import U from"../Core/Utilities.js";var addEvent=U.addEvent,clamp=U.clamp,correctFloat=U.correctFloat,defined=U.defined,find=U.find,isNumber=U.isNumber,isObject=U.isObject,merge=U.merge,pick=U.pick;import"./ColumnSeries.js";var Series=H.Series,seriesTypes=BaseSeries.seriesTypes,columnType=seriesTypes.column;function getColorByCategory(t,i){var e=t.options.colors||t.chart.options.colors,o=e?e.length:t.chart.options.chart.colorCount,r=i.y%o;return{colorIndex:r,color:e&&e[r]}}import"./ColumnSeries.js";BaseSeries.seriesType("xrange","column",{colorByPoint:!0,dataLabels:{formatter:function(){var t=this.point.partialFill;if(isObject(t)&&(t=t.amount),isNumber(t)&&t>0)return correctFloat(100*t)+"%"},inside:!0,verticalAlign:"middle"},tooltip:{headerFormat:'<span style="font-size: 10px">{point.x} - {point.x2}</span><br/>',pointFormat:'<span style="color:{point.color}">‚óè</span> {series.name}: <b>{point.yCategory}</b><br/>'},borderRadius:3,pointRange:0},{type:"xrange",parallelArrays:["x","x2","y"],requireSorting:!1,animate:seriesTypes.line.prototype.animate,cropShoulder:1,getExtremesFromAll:!0,autoIncrement:H.noop,buildKDTree:H.noop,init:function(){seriesTypes.column.prototype.init.apply(this,arguments),this.options.stacking=void 0},getColumnMetrics:function(){var t,i=this.chart;function e(){i.series.forEach(function(t){var i=t.xAxis;t.xAxis=t.yAxis,t.yAxis=i})}return e(),t=columnType.prototype.getColumnMetrics.call(this),e(),t},cropData:function(t,i,e,o){var r=Series.prototype.cropData.call(this,this.x2Data,i,e,o);return r.xData=t.slice(r.start,r.end),r},findPointIndex:function(t){var i,e,o=this.cropped,r=this.cropStart,s=this.points,a=t.id;a&&(i=(e=find(s,function(t){return t.id===a}))?e.index:void 0);void 0===i&&(i=(e=find(s,function(i){return i.x===t.x&&i.x2===t.x2&&!i.touched}))?e.index:void 0);return o&&isNumber(i)&&isNumber(r)&&i>=r&&(i-=r),i},translatePoint:function(t){var i,e,o,r,s,a,n,l,p=this.xAxis,c=this.yAxis,h=this.columnMetrics,d=this.options,u=d.minPointLength||0,m=t.plotX,g=pick(t.x2,t.x+(t.len||0)),f=p.translate(g,0,0,0,1),x=Math.abs(f-m),y=this.chart.inverted,b=pick(d.borderWidth,1)%2/2,C=h.offset,v=Math.round(h.width);u&&((i=u-x)<0&&(i=0),m-=i/2,f+=i/2),m=Math.max(m,-10),f=clamp(f,-10,p.len+10),defined(t.options.pointWidth)&&(C-=(Math.ceil(t.options.pointWidth)-v)/2,v=Math.ceil(t.options.pointWidth)),d.pointPlacement&&isNumber(t.plotY)&&c.categories&&(t.plotY=c.translate(t.y,0,1,0,1,d.pointPlacement)),t.shapeArgs={x:Math.floor(Math.min(m,f))+b,y:Math.floor(t.plotY+C)+b,width:Math.round(Math.abs(f-m)),height:v,r:this.options.borderRadius},s=(r=t.shapeArgs.x)+t.shapeArgs.width,r<0||s>p.len?(r=clamp(r,0,p.len),a=(s=clamp(s,0,p.len))-r,t.dlBox=merge(t.shapeArgs,{x:r,width:s-r,centerX:a?a/2:null})):t.dlBox=null;var A=t.tooltipPos,M=y?1:0,S=y?0:1;l=this.columnMetrics?this.columnMetrics.offset:-h.width/2,A[M]=clamp(A[M]+(y?-1:1)*(p.reversed?-1:1)*(x/2),0,p.len-1),A[S]=clamp(A[S]+(y?-1:1)*l,0,c.len-1),(o=t.partialFill)&&(isObject(o)&&(o=o.amount),isNumber(o)||(o=0),e=t.shapeArgs,t.partShapeArgs={x:e.x,y:e.y,width:e.width,height:e.height,r:this.options.borderRadius},n=Math.max(Math.round(x*o+t.plotX-m),0),t.clipRectArgs={x:p.reversed?e.x+x-n:e.x,y:e.y,width:n,height:e.height})},translate:function(){columnType.prototype.translate.apply(this,arguments),this.points.forEach(function(t){this.translatePoint(t)},this)},drawPoint:function(t,i){var e,o=this.options,r=this.chart.renderer,s=t.graphic,a=t.shapeType,n=t.shapeArgs,l=t.partShapeArgs,p=t.clipRectArgs,c=t.partialFill,h=o.stacking&&!o.borderRadius,d=t.state,u=o.states[d||"normal"]||{},m=void 0===d?"attr":i,g=this.pointAttribs(t,d),f=pick(this.chart.options.chart.animation,u.animation);t.isNull||!1===t.visible?s&&(t.graphic=s.destroy()):(s?s.rect[i](n):(t.graphic=s=r.g("point").addClass(t.getClassName()).add(t.group||this.group),s.rect=r[a](merge(n)).addClass(t.getClassName()).addClass("highcharts-partfill-original").add(s)),l&&(s.partRect?(s.partRect[i](merge(l)),s.partialClipRect[i](merge(p))):(s.partialClipRect=r.clipRect(p.x,p.y,p.width,p.height),s.partRect=r[a](l).addClass("highcharts-partfill-overlay").add(s).clip(s.partialClipRect))),this.chart.styledMode||(s.rect[i](g,f).shadow(o.shadow,null,h),l&&(isObject(c)||(c={}),isObject(o.partialFill)&&(c=merge(o.partialFill,c)),e=c.fill||color(g.fill).brighten(-.3).get()||color(t.color||this.color).brighten(-.3).get(),g.fill=e,s.partRect[m](g,f).shadow(o.shadow,null,h))))},drawPoints:function(){var t=this,i=t.getAnimationVerb();t.points.forEach(function(e){t.drawPoint(e,i)})},getAnimationVerb:function(){return this.chart.pointCount<(this.options.animationLimit||250)?"animate":"attr"}},{resolveColor:function(){var t,i=this.series;i.options.colorByPoint&&!this.options.color?(t=getColorByCategory(i,this),i.chart.styledMode||(this.color=t.color),this.options.colorIndex||(this.colorIndex=t.colorIndex)):this.color||(this.color=i.color)},init:function(){return Point.prototype.init.apply(this,arguments),this.y||(this.y=0),this},setState:function(){Point.prototype.setState.apply(this,arguments),this.series.drawPoint(this,this.series.getAnimationVerb())},getLabelConfig:function(){var t=Point.prototype.getLabelConfig.call(this),i=this.series.yAxis.categories;return t.x2=this.x2,t.yCategory=this.yCategory=i&&i[this.y],t},tooltipDateKeys:["x","x2"],isValid:function(){return"number"==typeof this.x&&"number"==typeof this.x2}}),addEvent(Axis,"afterGetSeriesExtremes",function(){var t,i,e=this.series;this.isXAxis&&(t=pick(this.dataMax,-Number.MAX_VALUE),e.forEach(function(e){e.x2Data&&e.x2Data.forEach(function(e){e>t&&(t=e,i=!0)})}),i&&(this.dataMax=t))});