import BaseSeries from"../Core/Series/Series.js";import ColumnSeries from"./ColumnSeries.js";var colProto=ColumnSeries.prototype;import U from"../Core/Utilities.js";var clamp=U.clamp,pick=U.pick;BaseSeries.seriesType("columnpyramid","column",{},{translate:function(){var t=this,e=t.chart,o=t.options,i=t.dense=t.closestPointRange*t.xAxis.transA<2,r=t.borderWidth=pick(o.borderWidth,i?0:1),s=t.yAxis,p=o.threshold,a=t.translatedThreshold=s.getThreshold(p),l=pick(o.minPointLength,5),n=t.getColumnMetrics(),h=n.width,c=t.barW=Math.max(h,1+2*r),d=t.pointXOffset=n.offset;e.inverted&&(a-=.5),o.pointPadding&&(c=Math.ceil(c)),colProto.translate.apply(t),t.points.forEach(function(i){var r,n,m,y,f,g,x,u,v,M,P,S,k=pick(i.yBottom,a),C=999+Math.abs(k),W=clamp(i.plotY,-C,s.len+C),b=i.plotX+d,A=c/2,L=Math.min(W,k),T=Math.max(W,k)-L;i.barX=b,i.pointWidth=h,i.tooltipPos=e.inverted?[s.len+s.pos-e.plotLeft-W,t.xAxis.len-b-A,T]:[b+A,W+s.pos-e.plotTop,T],r=p+(i.total||i.y),"percent"===o.stacking&&(r=p+(i.y<0)?-100:100),m=s.toPixels(r,!0),x=b-(y=(n=e.plotHeight-m-(e.plotHeight-a))?A*(L-m)/n:0)+A,u=b+y+A,v=b+(f=n?A*(L+T-m)/n:0)+A,M=b-f+A,P=L-l,S=L+T,i.y<0&&(P=L,S=L+T+l),e.inverted&&(u=(x=b+A+(y=A*(m-(g=e.plotWidth-L))/(n=m-(e.plotWidth-a))))-2*y,v=b-(f=A*(m-(g-T))/n)+A,M=b+f+A,P=L,S=L+T-l,i.y<0&&(S=L+T+l)),i.shapeType="path",i.shapeArgs={x:x,y:P,width:u-x,height:T,d:[["M",x,P],["L",u,P],["L",v,S],["L",M,S],["Z"]]}})}});