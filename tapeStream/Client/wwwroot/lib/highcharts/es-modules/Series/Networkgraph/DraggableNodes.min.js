import Chart from"../../Core/Chart/Chart.js";import H from"../../Core/Globals.js";import U from"../../Core/Utilities.js";var addEvent=U.addEvent;H.dragNodesMixin={onMouseDown:function(o,t){var e=this.chart.pointer.normalize(t);o.fixedPosition={chartX:e.chartX,chartY:e.chartY,plotX:o.plotX,plotY:o.plotY},o.inDragMode=!0},onMouseMove:function(o,t){if(o.fixedPosition&&o.inDragMode){var e,i,a=this.chart,r=a.pointer.normalize(t),n=o.fixedPosition.chartX-r.chartX,s=o.fixedPosition.chartY-r.chartY,d=a.graphLayoutsLookup;(Math.abs(n)>5||Math.abs(s)>5)&&(e=o.fixedPosition.plotX-n,i=o.fixedPosition.plotY-s,a.isInsidePlot(e,i)&&(o.plotX=e,o.plotY=i,o.hasDragged=!0,this.redrawHalo(o),d.forEach(function(o){o.restartSimulation()})))}},onMouseUp:function(o,t){o.fixedPosition&&(o.hasDragged&&(this.layout.enableSimulation?this.layout.start():this.chart.redraw()),o.inDragMode=o.hasDragged=!1,this.options.fixedDraggable||delete o.fixedPosition)},redrawHalo:function(o){o&&this.halo&&this.halo.attr({d:o.haloPath(this.options.states.hover.halo.size)})}},addEvent(Chart,"load",function(){var o,t,e,i=this;i.container&&(o=addEvent(i.container,"mousedown",function(o){var a=i.hoverPoint;a&&a.series&&a.series.hasDraggableNodes&&a.series.options.draggable&&(a.series.onMouseDown(a,o),t=addEvent(i.container,"mousemove",function(o){return a&&a.series&&a.series.onMouseMove(a,o)}),e=addEvent(i.container.ownerDocument,"mouseup",function(o){return t(),e(),a&&a.series&&a.series.onMouseUp(a,o)}))})),addEvent(i,"destroy",function(){o()})});