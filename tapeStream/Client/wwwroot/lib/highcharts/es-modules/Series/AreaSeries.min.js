import BaseSeries from"../Core/Series/Series.js";import Color from"../Core/Color/Color.js";var color=Color.parse;import H from"../Core/Globals.js";import LegendSymbolMixin from"../Mixins/LegendSymbol.js";import U from"../Core/Utilities.js";var objectEach=U.objectEach,pick=U.pick;import"../Series/LineSeries.js";import"../Core/Options.js";var Series=H.Series;BaseSeries.seriesType("area","line",{threshold:0},{singleStacks:!1,getStackPoints:function(t){var i,e,r=[],o=[],s=this.xAxis,l=this.yAxis,a=l.stacking.stacks[this.stackKey],h={},n=this.index,p=l.series,c=p.length,f=pick(l.options.reversedStacks,!0)?1:-1;if(t=t||this.points,this.options.stacking){for(e=0;e<t.length;e++)t[e].leftNull=t[e].rightNull=void 0,h[t[e].x]=t[e];objectEach(a,function(t,i){null!==t.total&&o.push(i)}),o.sort(function(t,i){return t-i}),i=p.map(function(t){return t.visible}),o.forEach(function(t,p){var u,d,g=0;if(h[t]&&!h[t].isNull)r.push(h[t]),[-1,1].forEach(function(r){var s=1===r?"rightNull":"leftNull",l=1===r?"rightCliff":"leftCliff",g=0,m=a[o[p+r]];if(m)for(e=n;e>=0&&e<c;)(u=m.points[e])||(e===n?h[t][s]=!0:i[e]&&(d=a[t].points[e])&&(g-=d[1]-d[0])),e+=f;h[t][l]=g});else{for(e=n;e>=0&&e<c;){if(u=a[t].points[e]){g=u[1];break}e+=f}g=l.translate(g,0,1,0,1),r.push({isNull:!0,plotX:s.translate(t,0,0,0,1),x:t,plotY:g,yBottom:g})}})}return r},getGraphPath:function(t){var i,e,r,o,s,l,a,h,n=Series.prototype.getGraphPath,p=this.options,c=p.stacking,f=this.yAxis,u=[],d=[],g=this.index,m=f.stacking.stacks[this.stackKey],k=p.threshold,C=Math.round(f.getThreshold(p.threshold)),v=pick(p.connectNulls,"percent"===c),x=function(i,e,r){var o,s,a=t[i],h=c&&m[a.x].points[g],n=a[r+"Null"]||0,p=a[r+"Cliff"]||0,v=!0;p||n?(o=(n?h[0]:h[1])+p,s=h[0]+p,v=!!n):!c&&t[e]&&t[e].isNull&&(o=s=k),void 0!==o&&(d.push({plotX:l,plotY:null===o?C:f.getThreshold(o),isNull:v,isCliff:!0}),u.push({plotX:l,plotY:null===s?C:f.getThreshold(s),doCurve:!1}))};for(t=t||this.points,c&&(t=this.getStackPoints(t)),o=0;o<t.length;o++)c||(t[o].leftCliff=t[o].rightCliff=t[o].leftNull=t[o].rightNull=void 0),a=t[o].isNull,l=pick(t[o].rectPlotX,t[o].plotX),h=c?t[o].yBottom:C,a&&!v||(v||x(o,o-1,"left"),a&&!c&&v||(d.push(t[o]),u.push({x:o,plotX:l,plotY:h})),v||x(o,o+1,"right"));e=n.call(this,d,!0,!0),u.reversed=!0;var S=(r=n.call(this,u,!0,!0))[0];return S&&"M"===S[0]&&(r[0]=["L",S[1],S[2]]),s=e.concat(r),i=n.call(this,d,!1,v),s.xMap=e.xMap,this.areaPath=s,i},drawGraph:function(){this.areaPath=[],Series.prototype.drawGraph.apply(this);var t=this,i=this.areaPath,e=this.options,r=this.zones,o=[["area","highcharts-area",this.color,e.fillColor]];r.forEach(function(i,r){o.push(["zone-area-"+r,"highcharts-area highcharts-zone-area-"+r+" "+i.className,i.color||t.color,i.fillColor||e.fillColor])}),o.forEach(function(r){var o=r[0],s=t[o],l=s?"animate":"attr",a={};s?(s.endX=t.preventGraphAnimation?null:i.xMap,s.animate({d:i})):(a.zIndex=0,(s=t[o]=t.chart.renderer.path(i).addClass(r[1]).add(t.group)).isArea=!0),t.chart.styledMode||(a.fill=pick(r[3],color(r[2]).setOpacity(pick(e.fillOpacity,.75)).get())),s[l](a),s.startX=i.xMap,s.shiftUnit=e.step?2:1})},drawLegendSymbol:LegendSymbolMixin.drawRectangle});