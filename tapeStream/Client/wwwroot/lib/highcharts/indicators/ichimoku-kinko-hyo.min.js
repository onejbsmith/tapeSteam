!function(n){"object"==typeof module&&module.exports?module.exports=n.default=n:"function"==typeof define&&define.amd?define("highcharts/indicators/ichimoku-kinko-hyo",["highcharts","highcharts/modules/stock"],function(o){return n(o),n.Highcharts=o,n}):n("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(o){function n(o,n,t,e){o.hasOwnProperty(n)||(o[n]=e.apply(null,t))}n(o=o?o._modules:{},"Stock/Indicators/IKHIndicator.js",[o["Core/Series/Series.js"],o["Core/Color/Color.js"],o["Core/Globals.js"],o["Core/Utilities.js"]],function(o,n,i,t){function m(o){return{high:o.reduce(function(o,n){return Math.max(o,n[1])},-1/0),low:o.reduce(function(o,n){return Math.min(o,n[2])},1/0)}}function A(o,n,t,e){if(o&&n&&t&&e){var i=n.plotX-o.plotX;n=n.plotY-o.plotY;var p=e.plotX-t.plotX;e=e.plotY-t.plotY;var a=o.plotX-t.plotX,l=o.plotY-t.plotY;if(t=(-n*a+i*l)/(-p*n+i*e),p=(p*l-e*a)/(-p*n+i*e),0<=t&&t<=1&&0<=p&&p<=1)return{plotX:o.plotX+p*i,plotY:o.plotY+p*n}}return!1}function C(o){var n=o.indicator;n.points=o.points,n.nextPoints=o.nextPoints,n.color=o.color,n.options=P(o.options.senkouSpan.styles,o.gap),n.graph=o.graph,n.fillGraph=!0,j.prototype.drawGraph.call(n)}var e=n.parse,x=t.defined,Y=t.isArray,P=t.merge,B=t.objectEach,j=o.seriesTypes.sma;i.approximations["ichimoku-averages"]=function(){var t,e=[];return[].forEach.call(arguments,function(o,n){e.push(i.approximations.average(o)),t=!t&&void 0===e[n]}),t?void 0:e},o.seriesType("ikh","sma",{params:{period:26,periodTenkan:9,periodSenkouSpanB:52},marker:{enabled:!1},tooltip:{pointFormat:'<span style="color:{point.color}">‚óè</span> <b> {series.name}</b><br/>TENKAN SEN: {point.tenkanSen:.3f}<br/>KIJUN SEN: {point.kijunSen:.3f}<br/>CHIKOU SPAN: {point.chikouSpan:.3f}<br/>SENKOU SPAN A: {point.senkouSpanA:.3f}<br/>SENKOU SPAN B: {point.senkouSpanB:.3f}<br/>'},tenkanLine:{styles:{lineWidth:1,lineColor:void 0}},kijunLine:{styles:{lineWidth:1,lineColor:void 0}},chikouLine:{styles:{lineWidth:1,lineColor:void 0}},senkouSpanA:{styles:{lineWidth:1,lineColor:void 0}},senkouSpanB:{styles:{lineWidth:1,lineColor:void 0}},senkouSpan:{styles:{fill:"rgba(255, 0, 0, 0.5)"}},dataGrouping:{approximation:"ichimoku-averages"}},{pointArrayMap:["tenkanSen","kijunSen","chikouSpan","senkouSpanA","senkouSpanB"],pointValKey:"tenkanSen",nameComponents:["periodSenkouSpanB","period","periodTenkan"],init:function(){j.prototype.init.apply(this,arguments),this.options=P({tenkanLine:{styles:{lineColor:this.color}},kijunLine:{styles:{lineColor:this.color}},chikouLine:{styles:{lineColor:this.color}},senkouSpanA:{styles:{lineColor:this.color,fill:e(this.color).setOpacity(.5).get()}},senkouSpanB:{styles:{lineColor:this.color,fill:e(this.color).setOpacity(.5).get()}},senkouSpan:{styles:{fill:e(this.color).setOpacity(.2).get()}}},this.options)},toYData:function(o){return[o.tenkanSen,o.kijunSen,o.chikouSpan,o.senkouSpanA,o.senkouSpanB]},translate:function(){var t=this;j.prototype.translate.apply(t),t.points.forEach(function(n){t.pointArrayMap.forEach(function(o){x(n[o])&&(n["plot"+o]=t.yAxis.toPixels(n[o],!0),n.plotY=n["plot"+o],n.tooltipPos=[n.plotX,n["plot"+o]],n.isNull=!1)})})},drawGraph:function(){var t,o,e=this,n=e.points,i=n.length,p=e.options,a=e.graph,l=e.color,r={options:{gapSize:p.gapSize}},s=e.pointArrayMap.length,h=[[],[],[],[],[],[]],u={tenkanLine:h[0],kijunLine:h[1],chikouLine:h[2],senkouSpanA:h[3],senkouSpanB:h[4],senkouSpan:h[5]},c=[],f=e.options.senkouSpan,k=f.color||f.styles.fill,g=f.negativeColor,S=[[],[]],d=[[],[]],y=0;for(e.ikhMap=u;i--;){for(var v=n[i],m=0;m<s;m++)f=e.pointArrayMap[m],x(v[f])&&h[m].push({plotX:v.plotX,plotY:v["plot"+f],isNull:!1});g&&i!==n.length-1&&(f=u.senkouSpanB.length-1,m={plotX:(v=A(u.senkouSpanA[f-1],u.senkouSpanA[f],u.senkouSpanB[f-1],u.senkouSpanB[f])).plotX,plotY:v.plotY,isNull:!1,intersectPoint:!0},v&&(u.senkouSpanA.splice(f,0,m),u.senkouSpanB.splice(f,0,m),c.push(f)))}if(B(u,function(o,n){p[n]&&"senkouSpan"!==n&&(e.points=h[y],e.options=P(p[n].styles,r),e.graph=e["graph"+n],e.fillGraph=!1,e.color=l,j.prototype.drawGraph.call(e),e["graph"+n]=e.graph),y++}),e.graphCollection&&e.graphCollection.forEach(function(o){e[o].destroy(),delete e[o]}),e.graphCollection=[],g&&u.senkouSpanA[0]&&u.senkouSpanB[0]){for(c.unshift(0),c.push(u.senkouSpanA.length-1),s=0;s<c.length-1;s++){if(f=c[s],v=c[s+1],i=u.senkouSpanB.slice(f,v+1),f=u.senkouSpanA.slice(f,v+1),1<=Math.floor(i.length/2))if(i[v=Math.floor(i.length/2)].plotY===f[v].plotY){for(o=m=v=0;o<i.length;o++)v+=i[o].plotY,m+=f[o].plotY;v=m<v?0:1}else v=i[v].plotY>f[v].plotY?0:1;else v=i[0].plotY>f[0].plotY?0:1;S[v]=S[v].concat(i),d[v]=d[v].concat(f)}["graphsenkouSpanColor","graphsenkouSpanNegativeColor"].forEach(function(o,n){S[n].length&&d[n].length&&(t=0===n?k:g,C({indicator:e,points:S[n],nextPoints:d[n],color:t,options:p,gap:r,graph:e[o]}),e[o]=e.graph,e.graphCollection.push(o))})}else C({indicator:e,points:u.senkouSpanB,nextPoints:u.senkouSpanA,color:k,options:p,gap:r,graph:e.graphsenkouSpan}),e.graphsenkouSpan=e.graph;delete e.nextPoints,delete e.fillGraph,e.points=n,e.options=p,e.graph=a},getGraphPath:function(o){var n,t=[];if(o=o||this.points,this.fillGraph&&this.nextPoints){if((n=j.prototype.getGraphPath.call(this,this.nextPoints))&&n.length){n[0][0]="L",t=j.prototype.getGraphPath.call(this,o);for(var e=(n=n.slice(0,t.length)).length-1;0<=e;e--)t.push(n[e])}}else t=j.prototype.getGraphPath.apply(this,arguments);return t},getValues:function(o,n){var t=n.period,e=n.periodTenkan;n=n.periodSenkouSpanB;var i,p,a,l,r=o.xData,s=o.yData,h=s&&s.length||0;o.xAxis.series.forEach(function(o){if(o.xData)for(a=o.xData,l=o.xIncrement?1:a.length-1;0<l;l--)p=a[l]-a[l-1],(void 0===i||p<i)&&(i=p)}),o=i;var u=[],c=[];if(!(r.length<=t)&&Y(s[0])&&4===s[0].length){for(var f,k,g,S,d=r[0]-t*o,y=0;y<t;y++)c.push(d+y*o);for(y=0;y<h;y++){e<=y&&(f=((f=m(f=s.slice(y-e,y))).high+f.low)/2),t<=y&&(g=(f+(k=((k=m(k=s.slice(y-t,y))).high+k.low)/2))/2),n<=y&&(S=((S=m(S=s.slice(y-n,y))).high+S.low)/2),d=s[y][3];var v=r[y];void 0===u[y]&&(u[y]=[]),void 0===u[y+t]&&(u[y+t]=[]),u[y+t][0]=f,u[y+t][1]=k,u[y+t][2]=void 0,u[y][2]=d,y<=t&&(u[y+t][3]=void 0,u[y+t][4]=void 0),void 0===u[y+2*t]&&(u[y+2*t]=[]),u[y+2*t][3]=g,u[y+2*t][4]=S,c.push(v)}for(y=1;y<=t;y++)c.push(v+y*o);return{values:u,xData:c,yData:u}}}})}),n(o,"masters/indicators/ichimoku-kinko-hyo.src.js",[],function(){})});