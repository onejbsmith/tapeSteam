"use strict";!function(n){"object"==typeof module&&module.exports?module.exports=n.default=n:"function"==typeof define&&define.amd?define("highcharts/indicators/ichimoku-kinko-hyo",["highcharts","highcharts/modules/stock"],function(o){return n(o),n.Highcharts=o,n}):n("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(o){var n=o?o._modules:{};function t(o,n,t,e){o.hasOwnProperty(n)||(o[n]=e.apply(null,t))}t(n,"Stock/Indicators/IKHIndicator.js",[n["Core/Series/Series.js"],n["Core/Color/Color.js"],n["Core/Globals.js"],n["Core/Utilities.js"]],function(o,n,i,t){var e=n.parse,M=t.defined,N=t.isArray,w=t.merge,D=t.objectEach,K=o.seriesTypes.sma;function b(o){return{high:o.reduce(function(o,n){return Math.max(o,n[1])},-1/0),low:o.reduce(function(o,n){return Math.min(o,n[2])},1/0)}}function O(o,n,t,e){if(o&&n&&t&&e){var i=n.plotX-o.plotX,p=n.plotY-o.plotY,a=e.plotX-t.plotX,l=e.plotY-t.plotY,s=o.plotX-t.plotX,r=o.plotY-t.plotY,h=(-p*s+i*r)/(-a*p+i*l),u=(a*r-l*s)/(-a*p+i*l);if(0<=h&&h<=1&&0<=u&&u<=1)return{plotX:o.plotX+u*i,plotY:o.plotY+u*p}}return!1}function I(o){var n=o.indicator;n.points=o.points,n.nextPoints=o.nextPoints,n.color=o.color,n.options=w(o.options.senkouSpan.styles,o.gap),n.graph=o.graph,n.fillGraph=!0,K.prototype.drawGraph.call(n)}i.approximations["ichimoku-averages"]=function(){var t,e=[];return[].forEach.call(arguments,function(o,n){e.push(i.approximations.average(o)),t=!t&&void 0===e[n]}),t?void 0:e},o.seriesType("ikh","sma",{params:{period:26,periodTenkan:9,periodSenkouSpanB:52},marker:{enabled:!1},tooltip:{pointFormat:'<span style="color:{point.color}">‚óè</span> <b> {series.name}</b><br/>TENKAN SEN: {point.tenkanSen:.3f}<br/>KIJUN SEN: {point.kijunSen:.3f}<br/>CHIKOU SPAN: {point.chikouSpan:.3f}<br/>SENKOU SPAN A: {point.senkouSpanA:.3f}<br/>SENKOU SPAN B: {point.senkouSpanB:.3f}<br/>'},tenkanLine:{styles:{lineWidth:1,lineColor:void 0}},kijunLine:{styles:{lineWidth:1,lineColor:void 0}},chikouLine:{styles:{lineWidth:1,lineColor:void 0}},senkouSpanA:{styles:{lineWidth:1,lineColor:void 0}},senkouSpanB:{styles:{lineWidth:1,lineColor:void 0}},senkouSpan:{styles:{fill:"rgba(255, 0, 0, 0.5)"}},dataGrouping:{approximation:"ichimoku-averages"}},{pointArrayMap:["tenkanSen","kijunSen","chikouSpan","senkouSpanA","senkouSpanB"],pointValKey:"tenkanSen",nameComponents:["periodSenkouSpanB","period","periodTenkan"],init:function(){K.prototype.init.apply(this,arguments),this.options=w({tenkanLine:{styles:{lineColor:this.color}},kijunLine:{styles:{lineColor:this.color}},chikouLine:{styles:{lineColor:this.color}},senkouSpanA:{styles:{lineColor:this.color,fill:e(this.color).setOpacity(.5).get()}},senkouSpanB:{styles:{lineColor:this.color,fill:e(this.color).setOpacity(.5).get()}},senkouSpan:{styles:{fill:e(this.color).setOpacity(.2).get()}}},this.options)},toYData:function(o){return[o.tenkanSen,o.kijunSen,o.chikouSpan,o.senkouSpanA,o.senkouSpanB]},translate:function(){var t=this;K.prototype.translate.apply(t),t.points.forEach(function(n){t.pointArrayMap.forEach(function(o){M(n[o])&&(n["plot"+o]=t.yAxis.toPixels(n[o],!0),n.plotY=n["plot"+o],n.tooltipPos=[n.plotX,n["plot"+o]],n.isNull=!1)})})},drawGraph:function(){var o,n,t,e,i,p,a,l,s,r,h,u,c,f,k,g,S=this,d=S.points,y=d.length,v=S.options,m=S.graph,A=S.color,C={options:{gapSize:v.gapSize}},x=S.pointArrayMap.length,Y=[[],[],[],[],[],[]],P={tenkanLine:Y[0],kijunLine:Y[1],chikouLine:Y[2],senkouSpanA:Y[3],senkouSpanB:Y[4],senkouSpan:Y[5]},B=[],j=S.options.senkouSpan,N=j.color||j.styles.fill,b=j.negativeColor,G=[[],[]],X=[[],[]],E=0;for(S.ikhMap=P;y--;){for(n=d[y],t=0;t<x;t++)o=S.pointArrayMap[t],M(n[o])&&Y[t].push({plotX:n.plotX,plotY:n["plot"+o],isNull:!1});b&&y!==d.length-1&&(f=P.senkouSpanB.length-1,g={plotX:(k=O(P.senkouSpanA[f-1],P.senkouSpanA[f],P.senkouSpanB[f-1],P.senkouSpanB[f])).plotX,plotY:k.plotY,isNull:!1,intersectPoint:!0},k&&(P.senkouSpanA.splice(f,0,g),P.senkouSpanB.splice(f,0,g),B.push(f)))}if(D(P,function(o,n){v[n]&&"senkouSpan"!==n&&(S.points=Y[E],S.options=w(v[n].styles,C),S.graph=S["graph"+n],S.fillGraph=!1,S.color=A,K.prototype.drawGraph.call(S),S["graph"+n]=S.graph),E++}),S.graphCollection&&S.graphCollection.forEach(function(o){S[o].destroy(),delete S[o]}),S.graphCollection=[],b&&P.senkouSpanA[0]&&P.senkouSpanB[0]){for(B.unshift(0),B.push(P.senkouSpanA.length-1),u=0;u<B.length-1;u++)if(e=B[u],i=B[u+1],p=P.senkouSpanB.slice(e,i+1),a=P.senkouSpanA.slice(e,i+1),1<=Math.floor(p.length/2)){var L=Math.floor(p.length/2);if(p[L].plotY===a[L].plotY){for(c=s=l=0;c<p.length;c++)l+=p[c].plotY,s+=a[c].plotY;G[h=s<l?0:1]=G[h].concat(p),X[h]=X[h].concat(a)}else h=p[L].plotY>a[L].plotY?0:1,G[h]=G[h].concat(p),X[h]=X[h].concat(a)}else h=p[0].plotY>a[0].plotY?0:1,G[h]=G[h].concat(p),X[h]=X[h].concat(a);["graphsenkouSpanColor","graphsenkouSpanNegativeColor"].forEach(function(o,n){G[n].length&&X[n].length&&(r=0===n?N:b,I({indicator:S,points:G[n],nextPoints:X[n],color:r,options:v,gap:C,graph:S[o]}),S[o]=S.graph,S.graphCollection.push(o))})}else I({indicator:S,points:P.senkouSpanB,nextPoints:P.senkouSpanA,color:N,options:v,gap:C,graph:S.graphsenkouSpan}),S.graphsenkouSpan=S.graph;delete S.nextPoints,delete S.fillGraph,S.points=d,S.options=v,S.graph=m},getGraphPath:function(o){var n,t=this,e=[],i=[];if(o=o||this.points,t.fillGraph&&t.nextPoints){if((n=K.prototype.getGraphPath.call(t,t.nextPoints))&&n.length){n[0][0]="L",e=K.prototype.getGraphPath.call(t,o);for(var p=(i=n.slice(0,e.length)).length-1;0<=p;p--)e.push(i[p])}}else e=K.prototype.getGraphPath.apply(t,arguments);return e},getValues:function(o,n){var t,e,i,p,a,l,s,r,h,u,c,f,k,g,S,d,y=n.period,v=n.periodTenkan,m=n.periodSenkouSpanB,A=o.xData,C=o.yData,x=o.xAxis,Y=C&&C.length||0,P=(x.series.forEach(function(o){if(o.xData)for(S=o.xData,k=o.xIncrement?1:S.length-1,d=k;0<d;d--)g=S[d]-S[d-1],(void 0===f||g<f)&&(f=g)}),f),B=[],j=[];if(!(A.length<=y)&&N(C[0])&&4===C[0].length){for(t=A[0]-y*P,l=0;l<y;l++)j.push(t+l*P);for(l=0;l<Y;l++)v<=l&&(s=((i=b(C.slice(l-v,l))).high+i.low)/2),y<=l&&(u=(s+(r=((p=b(C.slice(l-y,l))).high+p.low)/2))/2),m<=l&&(c=((a=b(C.slice(l-m,l))).high+a.low)/2),h=C[l][3],e=A[l],void 0===B[l]&&(B[l]=[]),void 0===B[l+y]&&(B[l+y]=[]),B[l+y][0]=s,B[l+y][1]=r,B[l+y][2]=void 0,B[l][2]=h,l<=y&&(B[l+y][3]=void 0,B[l+y][4]=void 0),void 0===B[l+2*y]&&(B[l+2*y]=[]),B[l+2*y][3]=u,B[l+2*y][4]=c,j.push(e);for(l=1;l<=y;l++)j.push(e+l*P);return{values:B,xData:j,yData:B}}}})}),t(n,"masters/indicators/ichimoku-kinko-hyo.src.js",[],function(){})});